(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70341,       1773]
NotebookOptionsPosition[     64892,       1695]
NotebookOutlinePosition[     65356,       1713]
CellTagsIndexPosition[     65313,       1710]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Conformal Barycenter Sampling Examples", "Title",
 CellChangeTimes->{{3.8711040716895733`*^9, 
  3.8711040871465397`*^9}},ExpressionUUID->"3ecf1c72-14b9-4a08-a317-\
e8d7b3693bc4"],

Cell["\<\
This notebook demonstrates the use of the conformal barycenter sampler by \
computing some example histograms for functions where we know the expected \
answers and comparing the results. \
\>", "Text",
 CellChangeTimes->{{3.871104090571639*^9, 3.871104105202362*^9}, {
  3.87110420472656*^9, 
  3.871104230694569*^9}},ExpressionUUID->"5798f9b8-63da-4821-af98-\
7aa30d997ea2"],

Cell[BoxData["Exit"], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"9d02376a-18f9-4c6c-8b18-59580cdd602c"],

Cell[CellGroupData[{

Cell["Loading the sampler", "Section",
 CellChangeTimes->{{3.871104235959197*^9, 
  3.8711042384415483`*^9}},ExpressionUUID->"3e6f1aba-91a1-40fc-aacf-\
e8cc2e4619d4"],

Cell["\<\
The only step in setting up the sampler is \
Get[\[OpenCurlyDoubleQuote]CycleSamplerLink.m\[CloseCurlyDoubleQuote]]. \
However, you need to locate this file on your system (so alter the path below \
accordingly, if needed). \
\>", "Text",
 CellChangeTimes->{{3.8711042571221933`*^9, 3.8711043104642487`*^9}, {
  3.879590143280939*^9, 
  3.879590143509719*^9}},ExpressionUUID->"0d7203f6-405f-4a43-80db-\
9f4f57266304"],

Cell[BoxData[{
 RowBox[{"file", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ParentDirectory", "[", 
      RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
     "\"\<CycleSamplerLink.m\>\""}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "file", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.879590145172353*^9, 3.8795901692766438`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"85342e5f-8dca-4a40-9649-89324f31daa0"],

Cell["The simplest sampling function is ", "Text",
 CellChangeTimes->{{3.871104326159788*^9, 
  3.871104357239489*^9}},ExpressionUUID->"522eb636-2fa5-4264-916b-\
52c77375c948"],

Cell[BoxData[
 RowBox[{"?", "RandomClosedPolygons"}]], "Input",
 CellChangeTimes->{{3.87110432927864*^9, 3.8711043355147877`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"094cd658-2cf0-45ad-9a48-52ec18f49d1a"],

Cell["\<\
This stores all of the sampled results in memory, so it\[CloseCurlyQuote]s \
best for sample counts in the millions or tens of millions. \
\>", "Text",
 CellChangeTimes->{{3.871105899117745*^9, 
  3.871105902542756*^9}},ExpressionUUID->"f1b5ed18-bb2e-4474-aac2-\
ea49ab769dfb"],

Cell["\<\
The first parameter, d, is the ambient dimension for the polygons.\
\>", "Text",
 CellChangeTimes->{{3.871105908957703*^9, 3.871105910488288*^9}, {
  3.871106240338994*^9, 
  3.871106249868627*^9}},ExpressionUUID->"089ee0b0-5cd1-49d9-828e-\
4f143999f415"],

Cell[TextData[{
 "To understand the roles of \[Omega] and \[Rho],  remember that if the \
edgelengths ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["r", "TI"], "1"], ",", "\[Ellipsis]", ",", 
         SubscriptBox[
          StyleBox["r", "TI"], 
          StyleBox["n", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "r_1, \\dotsc, r_n", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "802f43c9-9357-48c6-8120-5c32948c1ac4"],
 "are different from one another, there are different plausible choices of \
metric for the space of polygons. If ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SuperscriptBox[
          StyleBox["S", "TI"], 
          RowBox[{
            StyleBox["d", "TI"], "-", "1"}]], "(", 
         StyleBox["r", "TI"], ")"}], TraditionalForm], "errors" -> {}, 
     "input" -> "S^{d-1}(r)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c4bb2871-798a-4c01-b5ed-8fef83b36412"],
 " is the sphere of radius ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["r", "TI"], TraditionalForm], "errors" -> {}, "input" -> "r", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "66a4cf2c-2984-4b45-b845-a1182f8b5f98"],
 ", we may define\n\n\t",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"Pol", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["n", "TI"], ",", 
             StyleBox["r", "TI"]}], ")"}], "\[LongEqual]", 
         RowBox[{"{", 
           RowBox[{
             StyleBox["x", "TI"], "\[Element]", 
             SuperscriptBox[
              StyleBox["S", "TI"], 
              RowBox[{
                StyleBox["d", "TI"], "-", "1"}]], 
             RowBox[{"(", "1", ")"}], "\[Cross]", "\[CenterEllipsis]", 
             "\[Cross]", 
             SuperscriptBox[
              StyleBox["S", "TI"], 
              RowBox[{
                StyleBox["d", "TI"], "-", "1"}]], 
             RowBox[{"(", "1", ")"}], "|", "\[Sum]", 
             SubscriptBox[
              StyleBox["r", "TI"], 
              StyleBox["i", "TI"]], 
             SubscriptBox[
              StyleBox["x", "TI"], 
              StyleBox["i", "TI"]], "\[LongEqual]", "0"}], "}"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\text{Pol}(n,r) = \\{ x \\in S^{d-1}(1) \\times \\cdots \\times \
S^{d-1}(1) \\mid \\sum r_i x_i = 0 \\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "34223473-b1ab-424f-bf8e-b775506efb6e"],
 "\n\nor we may define\n\n\t",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"Pol", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["n", "TI"], ",", 
             StyleBox["r", "TI"]}], ")"}], "\[LongEqual]", 
         RowBox[{"{", 
           RowBox[{
             StyleBox["x", "TI"], "\[Element]", 
             SuperscriptBox[
              StyleBox["S", "TI"], 
              RowBox[{
                StyleBox["d", "TI"], "-", "1"}]], 
             RowBox[{"(", 
               SubscriptBox[
                StyleBox["r", "TI"], "1"], ")"}], "\[Cross]", 
             "\[CenterEllipsis]", "\[Cross]", 
             SuperscriptBox[
              StyleBox["S", "TI"], 
              RowBox[{
                StyleBox["d", "TI"], "-", "1"}]], 
             RowBox[{"(", 
               SubscriptBox[
                StyleBox["r", "TI"], 
                StyleBox["n", "TI"]], ")"}], "|", "\[Sum]", 
             SubscriptBox[
              StyleBox["x", "TI"], 
              StyleBox["i", "TI"]], "\[LongEqual]", "0"}], "}"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\text{Pol}(n,r) = \\{ x \\in S^{d-1}(r_1) \\times \\cdots \\times \
S^{d-1}(r_n) \\mid \\sum x_i = 0 \\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4b7bac6c-664e-4d69-9979-d5f0cc64a680"],
 "\n\t\nIn the special case of Millson and Kapovich\[CloseCurlyQuote]s \
symplectic structure on polygons in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["R", FontSlant -> "Bold"], "3"], TraditionalForm], 
     "errors" -> {}, "input" -> "\\mathbf{R}^3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2c8b048f-a40d-4326-aefe-e808338f3175"],
 ", they define\n\n\t",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{"Pol", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["n", "TI"], ",", 
             StyleBox["r", "TI"]}], ")"}], "\[LongEqual]", 
         RowBox[{"{", 
           RowBox[{
             StyleBox["x", "TI"], "\[Element]", 
             SuperscriptBox[
              StyleBox["S", "TI"], "2"], 
             RowBox[{"(", 
               SqrtBox[
                SubscriptBox[
                 StyleBox["r", "TI"], "1"]], ")"}], "\[Cross]", 
             "\[CenterEllipsis]", "\[Cross]", 
             SuperscriptBox[
              StyleBox["S", "TI"], "2"], 
             RowBox[{"(", 
               SqrtBox[
                SubscriptBox[
                 StyleBox["r", "TI"], 
                 StyleBox["n", "TI"]]], ")"}], "|", "\[Sum]", 
             SqrtBox[
              SubscriptBox[
               StyleBox["r", "TI"], 
               StyleBox["i", "TI"]]], 
             SubscriptBox[
              StyleBox["x", "TI"], 
              StyleBox["i", "TI"]], "\[LongEqual]", "0"}], "}"}]}], 
       TraditionalForm], "errors" -> {}, "input" -> 
     "\\text{Pol}(n,r) = \\{ x \\in S^2(\\sqrt{r_1}) \\times \\cdots \\times \
S^2(\\sqrt{r_n}) \\mid \\sum \\sqrt{r_i} x_i = 0 \\}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c30ed70b-4b71-4fec-beeb-d92c66e97caa"],
 "\n\t\nThese choices yield different metrics on the space of polygons and \
hence different measures for sampling, so we allow the user to set the \
weights ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Omega]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "17579a6c-b0fa-4f86-99f2-836183ce449d"],
 " (the coefficients of ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["x", "TI"], 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "x_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "d25e377b-2071-4576-8bc6-24be9f395285"],
 " in the final sum) and the radii of the spheres ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox["\[Rho]", 
        StyleBox["i", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "\\rho_i", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6d93a9e8-c90f-4984-bd9b-bd2c6659472c"],
 " separately."
}], "Text",
 CellChangeTimes->{{3.871104365610437*^9, 3.871104394223751*^9}, {
  3.871104461296342*^9, 3.871104466604595*^9}, {3.8711045061436567`*^9, 
  3.871104551062454*^9}, {3.8711045861237373`*^9, 3.871104995674567*^9}, {
  3.871105060592574*^9, 3.8711051095288563`*^9}, {3.871105210843577*^9, 
  3.871105374197307*^9}, {3.871105424609726*^9, 3.871105428100561*^9}, {
  3.8711056246861153`*^9, 3.871105744263261*^9}, {3.871105821193449*^9, 
  3.8711059896546183`*^9}},ExpressionUUID->"d5e4232f-fdb0-4ebd-a287-\
4d521830d396"],

Cell[TextData[{
 "For equilateral polygons, we usually let ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Omega]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\omega", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0ef14c26-77f5-4c50-bd89-0fdec2e511c5"],
 " and ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["\[Rho]", TraditionalForm], "errors" -> {}, "input" -> 
     "\\rho", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "0b757817-2694-4752-8d56-bef40567045e"],
 " be vectors of all 1\[CloseCurlyQuote]s. "
}], "Text",
 CellChangeTimes->{{3.871105995534367*^9, 3.871106006897092*^9}, {
  3.871106057470146*^9, 
  3.871106100004395*^9}},ExpressionUUID->"9c24e67f-027c-46bd-85f7-\
54fd8e62e725"],

Cell["\<\
The last parameter, samplecount is the number of polygons generated. The \
sampler is extremely fast, but it does store all the samples in memory \
(rather than accumulating a sum on-the-fly). An estimate of the memory used \
is:\
\>", "Text",
 CellChangeTimes->{{3.871106257124886*^9, 3.871106328003541*^9}, {
  3.8711070993802156`*^9, 
  3.871107109100613*^9}},ExpressionUUID->"93cc0095-b353-44d4-afdf-\
cd3cd9ccf4fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SampleMemoryMB", "[", 
   RowBox[{"d_", ",", "\[Omega]_", ",", "\[Rho]_", ",", "samplecount_"}], 
   "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"NumberForm", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"8.0", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", 
            RowBox[{"Length", "[", "\[Omega]", "]"}]}], " ", "+", " ", "d", 
           "  ", "+", " ", 
           RowBox[{"d", " ", 
            RowBox[{"Length", "[", "\[Omega]", "]"}]}]}], ")"}], " ", 
         "samplecount"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1024", "*", "1024"}], ")"}]}], ",", "3"}], "]"}], ",", 
    "\"\<MB\>\""}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8711063510424757`*^9, 3.871106491213017*^9}, {
  3.871106536013266*^9, 3.8711065891166487`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"da2afddb-2faf-464d-8a3d-4e14716aced5"],

Cell[BoxData[
 RowBox[{"SampleMemoryMB", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "1000000"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.871106553996409*^9, 3.87110659602953*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"e1667daa-f5f3-444b-9727-98d099a2d670"],

Cell["Here\[CloseCurlyQuote]s a test run, generating 1 M 4-gons in 3-space.", \
"Text",
 CellChangeTimes->{{3.871107113911951*^9, 
  3.871107149257777*^9}},ExpressionUUID->"744483b5-870d-4d14-877b-\
a80d302e2ef9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"result", "=", 
    RowBox[{"RandomClosedPolygons", "[", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "1000000", 
      ",", 
      RowBox[{"\"\<ThreadCount\>\"", "->", "8"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.871103579287797*^9, 3.871103579374729*^9}, 
   3.8711037857574043`*^9, {3.8711043183641043`*^9, 3.871104320780629*^9}, {
   3.871106198593988*^9, 3.871106215405952*^9}, {3.8711071534546347`*^9, 
   3.871107187767826*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"887a1e45-4875-439c-bd27-75defc8bfd4a"],

Cell["\<\
We can see the result is an association with various elements:\
\>", "Text",
 CellChangeTimes->{{3.8711072116669416`*^9, 
  3.871107278467724*^9}},ExpressionUUID->"9c53d308-9055-41b1-b77d-\
d9e88734b188"],

Cell[BoxData[
 RowBox[{"result", "//", "Keys"}]], "Input",
 CellLabel->"In[9]:=",ExpressionUUID->"e86808f2-3dd9-4f69-8ee5-2211d4adac8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Comparing results for quotient of equilateral n-gons by SO(3).\
\>", "Section",
 CellChangeTimes->{{3.8711072933037567`*^9, 
  3.8711073165303698`*^9}},ExpressionUUID->"0163a8b1-7b3f-463f-bc9f-\
d65f585d589b"],

Cell["\<\
It is known that the PDF for the chordlengths of closed equilateral polygons \
(in the quotient measure) are given by certain piecewise-polynomial functions:\
\>", "Text",
 CellChangeTimes->{{3.871107397080049*^9, 
  3.8711074576018887`*^9}},ExpressionUUID->"48e1939d-0882-4f80-b802-\
bc4c21ff509e"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"cn", ",", "SA", ",", "chord", ",", "ChordPDF"}], "]"}]], "Input",
 CellChangeTimes->{{3.871387501061379*^9, 3.8713875232431803`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"83ce48d2-2bb5-4d86-9665-dd958b131128"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cn", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}]}], "*", "\[Pi]", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "3"}], ")"}], "!"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"k", "+", "1"}], ")"}]}], "*", 
       RowBox[{"Binomial", "[", 
        RowBox[{"n", ",", "k"}], "]"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"n", "-", 
          RowBox[{"2", "k"}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{"n", "-", "3"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "0", ",", 
        RowBox[{"Floor", "[", 
         RowBox[{"n", "/", "2"}], "]"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SA", "[", 
    RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"n", "\[Equal]", "2"}], ",", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "+", "1"}], ">", "0"}], ",", "1", ",", "0"}], "]"}], 
      "-", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"x", "-", "1"}], ">", "0"}], ",", "1", ",", "0"}], "]"}]}], 
     ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "-", "1"}], "]"}], "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}], "!"}]}], ")"}], "*", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "k"}], "*", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{"n", "-", "1"}], ",", "k"}], "]"}], "*", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"x", "+", "n", "-", "1", "-", 
             RowBox[{"2", "k"}]}], ",", "0"}], "]"}], "^", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "0", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]", "[", 
    RowBox[{"n_", ",", "l_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}]}], "*", "\[Pi]", "*", "l", "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"n", "-", "1"}], "]"}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SA", "[", 
       RowBox[{"n", ",", 
        RowBox[{"l", "-", "1"}]}], "]"}], "-", 
      RowBox[{"SA", "[", 
       RowBox[{"n", ",", 
        RowBox[{"l", "+", "1"}]}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chord", "[", 
    RowBox[{"n_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"cn", "[", "n", "]"}]}], ")"}], "*", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"4", "*", "\[Pi]", "*", 
       RowBox[{"x", "^", "3"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{"k", ",", "x"}], "]"}], "*", 
       RowBox[{"\[Phi]", "[", 
        RowBox[{
         RowBox[{"n", "-", "k"}], ",", "x"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "k"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChordPDFexact", "[", 
    RowBox[{"n_", ",", "k_", ",", "x_"}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"cn", "[", "n", "]"}]}], ")"}], 
    RowBox[{"(", " ", 
     RowBox[{"4", "*", "\[Pi]", "*", 
      RowBox[{"x", "^", "2"}], "*", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{"k", ",", "x"}], "]"}], "*", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{"n", "-", "k"}], ",", "x"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cna", "[", "n_", "]"}], " ", ":=", " ", 
   FractionBox[
    RowBox[{"3", " ", 
     SqrtBox[
      FractionBox["3", "2"]]}], 
    RowBox[{"2", " ", 
     SuperscriptBox["n", 
      RowBox[{"3", "/", "2"}]], " ", 
     SuperscriptBox["\[Pi]", 
      RowBox[{"3", "/", "2"}]]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChordPDFa", "[", 
    RowBox[{"n_", ",", "k_", ",", "x_"}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", 
      RowBox[{"cna", "[", "n", "]"}]}], ")"}], 
    RowBox[{"(", " ", 
     RowBox[{"4", "*", "\[Pi]", "*", 
      RowBox[{"x", "^", "2"}], "*", 
      RowBox[{"\[Phi]a", "[", 
       RowBox[{"k", ",", "x"}], "]"}], "*", 
      RowBox[{"\[Phi]a", "[", 
       RowBox[{
        RowBox[{"n", "-", "k"}], ",", "x"}], "]"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ChordPDFb", "[", 
    RowBox[{"n_", ",", "k_", ",", "x_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{"GammaDistribution", "[", 
      RowBox[{
       FractionBox["3", "2"], ",", 
       RowBox[{
        SqrtBox[
         FractionBox["2", "3"]], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "k"}], "+", "n"}], ")"}]}], "n"]]}], ",", "2", ",", 
       "0"}], "]"}], "]"}], "[", "x", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]a", "[", 
     RowBox[{"n_", ",", "l_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     FractionBox["3", 
      RowBox[{"2", "\[Pi]", " ", "n"}]], " ", 
     RowBox[{
      RowBox[{"PDF", "[", 
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", 
         SqrtBox[
          RowBox[{"n", "/", "3"}]]}], "]"}], "]"}], "[", "l", "]"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ChordPDF", "[", 
   RowBox[{"n_", ",", "k_", ",", "x_"}], "]"}], ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"n", "<", "20"}], ",", 
    RowBox[{"ChordPDFexact", "[", 
     RowBox[{"n", ",", "k", ",", "x"}], "]"}], ",", 
    RowBox[{"ChordPDFb", "[", 
     RowBox[{"n", ",", "k", ",", "x"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5924978434371567`*^9, 3.592497852974657*^9}, {
   3.592498117483116*^9, 3.592498157234572*^9}, {3.8711074789349422`*^9, 
   3.871107492554846*^9}, {3.871384308713146*^9, 3.871384356620779*^9}, {
   3.871384399262415*^9, 3.871384545206107*^9}, {3.871385066634918*^9, 
   3.871385080547183*^9}, {3.871387285681717*^9, 3.871387297144849*^9}, {
   3.8713873340957937`*^9, 3.871387402767331*^9}, {3.871387544563033*^9, 
   3.871387546641822*^9}, {3.871388174253065*^9, 3.8713883054860497`*^9}, {
   3.871388352026759*^9, 3.871388353538803*^9}, {3.871388410990039*^9, 
   3.871388512350299*^9}, {3.871388624522911*^9, 3.871388635434458*^9}, 
   3.871388700142227*^9, {3.8713887792003508`*^9, 3.871388811714014*^9}, {
   3.871389020550056*^9, 3.8713890259613867`*^9}, {3.871389114620611*^9, 
   3.871389122728156*^9}, {3.871389178397614*^9, 3.871389206799795*^9}, {
   3.8713893619711723`*^9, 3.871389395207225*^9}, {3.8713901802389936`*^9, 
   3.871390197465809*^9}, {3.87139029594641*^9, 3.871390341905835*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"534808c9-4241-4f43-8a30-8472a82631ab"],

Cell["\<\
We can plot this against the data from our sampling run as follows. We will \
consider skip-2 chords in our 4-gons, so we first need to collect their norms \
as WeightedData:\
\>", "Text",
 CellChangeTimes->{{3.8711076873393517`*^9, 
  3.871107736839109*^9}},ExpressionUUID->"83447d6f-52a3-4252-9484-\
2022949e85f5"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PDF", "[", 
      RowBox[{"GammaDistribution", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        RowBox[{"2", 
         SqrtBox["n"]}]}], "]"}], "]"}], "[", "l", "]"}], 
    RowBox[{
     RowBox[{"PDF", "[", 
      RowBox[{"GammaDistribution", "[", 
       RowBox[{
        FractionBox["3", "2"], ",", 
        RowBox[{"2", 
         SqrtBox[
          RowBox[{"n", "-", "k"}]]}]}], "]"}], "]"}], "[", "l", "]"}]}], ",", 
   
   RowBox[{"{", 
    RowBox[{"l", ",", "0", ",", "Infinity"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"n", ">", "0"}], ",", 
      RowBox[{"k", ">", "0"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.871388097659233*^9, 3.871388160870442*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"4e892c87-1f18-4b2a-a001-efb27e9ba24e"],

Cell[BoxData[
 RowBox[{"<<", "MaTeX`"}]], "Input",
 CellChangeTimes->{{3.854982144732895*^9, 3.854982155365096*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"794170e6-26e6-4517-bf25-8239fe1ab573"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fontSize", "=", "12"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"MaTeX", ",", 
    RowBox[{"FontSize", "\[Rule]", "fontSize"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<Preamble\>\"", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "\"\<\\\\usepackage{helvet}\>\"", "\[IndentingNewLine]", ",", 
       "\"\<\\\\usepackage{sansmathfonts}\>\"", "\[IndentingNewLine]", ",", 
       "\"\<\\\\usepackage{amsmath,amssymb}\>\"", "\[IndentingNewLine]", ",", 
       "\"\<\\\\renewcommand\\\\familydefault{\\\\sfdefault}\>\""}], 
      "\[IndentingNewLine]", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"BaseStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FontSize", "\[Rule]", "fontSize"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Math\>\""}]}], 
      "}"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.854639705345106*^9, 3.854639705520093*^9}, {
  3.854639867109867*^9, 3.854639867221945*^9}, {3.8546400292539454`*^9, 
  3.854640030597444*^9}, {3.871397041344994*^9, 3.871397053868431*^9}},
 CellLabel->"In[4]:=",
 CellID->960905662,
 $CellContext`ExpressionUUID -> 
 "030c9dd8-5214-426e-bed5-2ad5e1d366a5",ExpressionUUID->"2d18e6e8-0764-491c-\
b184-de0ccf8e98ec"],

Cell[BoxData[
 RowBox[{"Cols", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Lighter", "[", 
     RowBox[{
      RowBox[{"RGBColor", "[", "\"\<#506E86\>\"", "]"}], ",", "0.4"}], "]"}], 
    ",", 
    RowBox[{"Lighter", "[", 
     RowBox[{
      RowBox[{"RGBColor", "[", "\"\<#506E86\>\"", "]"}], ",", ".2"}], "]"}], 
    ",", 
    RowBox[{"RGBColor", "[", "\"\<#506E86\>\"", "]"}], ",", 
    RowBox[{"RGBColor", "[", "\"\<#DE703B\>\"", "]"}], ",", 
    RowBox[{"RGBColor", "[", "\"\<#FCB040\>\"", "]"}], ",", 
    RowBox[{"RGBColor", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"219", ",", "227", ",", "248"}], "}"}], "/", "255"}], "]"}], 
    ",", 
    RowBox[{"GrayLevel", "[", "0.2", "]"}], ",", 
    RowBox[{"GrayLevel", "[", "0.5", "]"}]}], "}"}]}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"2a0be4ee-b1c9-4a0e-97d9-cab350018c6c"],

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"cn", "[", "45", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.871388063871188*^9, 3.871388070702991*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"3055acfb-3c61-44d7-9b3a-d5f69289eb44"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"ChordPDF", "[", 
    RowBox[{"45", ",", "25", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", 
     RowBox[{"Min", "[", 
      RowBox[{"{", 
       RowBox[{"20", ",", "10"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Cols", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{
      RowBox[{"MaTeX", "[", 
       RowBox[{"\"\<\\\\textbf{Chord}(\>\"", "<>", 
        RowBox[{"ToString", "[", "4", "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"ToString", "[", "4", "]"}], "<>", "\"\<)\>\""}], "]"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"1", ",", "0.7"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"Center", ",", "Bottom"}], "}"}]}], "]"}]}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.871376444767569*^9, 3.8713764579399233`*^9}, {
   3.871376518546082*^9, 3.871376529690373*^9}, {3.871376563635994*^9, 
   3.8713765645181417`*^9}, {3.871388014404891*^9, 3.871388056354478*^9}, 
   3.8713902688857613`*^9, 3.871390351244787*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"850099b1-0feb-4356-aaf0-9506956e862e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChordlengthHistogram3D", "[", 
   RowBox[{"n_", ",", "k_", ",", "samplecount_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "SampledChordData", ",", "time"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "result"}], "}"}], " ", "=", " ", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{"RandomClosedPolygons", "[", 
        RowBox[{"3", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", "n"}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", "n"}], "]"}], ",", "samplecount", ",", 
         RowBox[{"\"\<ThreadCount\>\"", "->", "8"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SampledChordData", "=", " ", 
      RowBox[{"WeightedData", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "@", 
           RowBox[{"Total", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "k"}], "]"}], "]"}], "]"}]}], "&"}], "/@", 
         RowBox[{
         "result", "[", "\"\<ClosedPolygonUnitEdgeVectors\>\"", "]"}]}], ",", 
        
        RowBox[{
        "result", "[", "\"\<EdgeQuotientSpaceSamplingWeights\>\"", "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "result", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Histogram", "[", 
          RowBox[{
          "SampledChordData", ",", "\"\<FreedmanDiaconis\>\"", ",", 
           "\"\<PDF\>\"", ",", 
           RowBox[{"ChartStyle", "\[Rule]", 
            RowBox[{"Cols", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}]}], "]"}], ",", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"ChordPDF", "[", 
            RowBox[{"n", ",", "k", ",", "x"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", 
             RowBox[{"Min", "[", 
              RowBox[{"{", 
               RowBox[{"k", ",", 
                RowBox[{"n", "-", "k"}]}], "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"Thick", ",", 
              RowBox[{"Cols", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Ticks", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"MaTeX", "[", 
               RowBox[{"\"\<\\\\mathbf{\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<}\>\""}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", "None"}],
          "}"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "k"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AxesOrigin", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "30"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"\"\<\\\\text{length of chord skipping } \>\"", "<>", 
              RowBox[{"ToString", "[", "k", "]"}], "<>", 
              "\"\< \\\\text{ edges in } \
\\\\widehat{\\\\operatorname{Pol}}_3(\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", 
              "\"\<;\\\\vec{1})\>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"\"\<\\\\text{samples} = 10^\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"Log10", "[", "samplecount", "]"}], "]"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", "/", "3"}], ",", 
              RowBox[{"-", "0.1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"\"\<\\\\text{time} = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"time", ",", "3"}], "]"}], "]"}], "<>", 
              "\"\< s\>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"k", "/", "3"}]}], ",", 
              RowBox[{"-", "0.1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/eig3ZTe628cBbYorADRdlFRa0B03OVUMN3gPeMG
iGZpefoeRG+ON/oKol/ziX4H0afYZ/4G0X3rFoLpuLANnVuBtNwxpS4QfUDn
0u4DQPqT/YW9IJovNjFB4MYbxy5R3XQQ7eu9shBEt053qQDRXHsla0H0pWdC
rSCanVNgBog+tuglmO45/XQuiNZ/u/EliOawuvoORLv4qP8G0XedxYQEgfSR
gIdgevexcgkQ/cG2TAFEX2U/pAqi467L6IBoK7mtliD62fxXViDaz6WnCETv
s+4H02/7FB9Igdz59QKYrkkMfwuiO0IzwTQA00yteg==
  "],
 CellLabel->"In[30]:=",ExpressionUUID->"f80c6cd6-babb-489f-8c0a-63187608cfe6"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<../../talks/4-gon-chord-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"Echo", "@", 
      RowBox[{"ChordlengthHistogram3D", "[", 
       RowBox[{"4", ",", "2", ",", 
        SuperscriptBox["10", "i"]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.871108427284699*^9, 3.8711084403155203`*^9}, {
  3.871190124278883*^9, 3.871190264999601*^9}, {3.87119052959538*^9, 
  3.871190531317685*^9}, {3.871376236140502*^9, 3.871376236306332*^9}, {
  3.871377381051044*^9, 3.87137738140934*^9}, {3.871377655269615*^9, 
  3.871377655506371*^9}, {3.871377775998782*^9, 3.871377776411715*^9}, {
  3.8713795622019444`*^9, 3.871379564395611*^9}, {3.871396786960536*^9, 
  3.871396793228348*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"f5f50780-3dfb-434f-8400-26e660bd981d"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<../../talks/5-gon-chord-2-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"Echo", "@", 
      RowBox[{"ChordlengthHistogram3D", "[", 
       RowBox[{"5", ",", "2", ",", 
        SuperscriptBox["10", "i"]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8711903456613503`*^9, 3.871190361346983*^9}, {
  3.871190508401167*^9, 3.871190508753578*^9}, {3.871379558150691*^9, 
  3.871379559936225*^9}, {3.8713970899191093`*^9, 3.871397095188574*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"3b2551c1-7415-47a6-81ad-13e19c32def7"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<../../talks/6-gon-chord-3-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"Echo", "@", 
      RowBox[{"ChordlengthHistogram3D", "[", 
       RowBox[{"6", ",", "3", ",", 
        SuperscriptBox["10", "i"]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8711903910035267`*^9, 3.871190404304872*^9}, {
  3.871190466750753*^9, 3.87119046792899*^9}, {3.8713795537891703`*^9, 
  3.871379555860478*^9}, {3.8713971006677437`*^9, 3.8713971052240877`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"aa790d26-8fff-4097-afd5-7f1fab99881c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ChordlengthHistogram3DBig", "[", 
    RowBox[{"n_", ",", "k_", ",", "samplecount_", ",", 
     RowBox[{"{", 
      RowBox[{"xrange_", ",", "yrange_"}], "}"}]}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"result", ",", "SampledChordData", ",", "time"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"time", ",", "SampledChordData"}], "}"}], " ", "=", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
        RowBox[{"WeightedData", "@@", 
         RowBox[{"(", 
          RowBox[{"Transpose", "[", 
           RowBox[{"(", 
            RowBox[{"(", 
             RowBox[{"Transpose", "[", 
              RowBox[{"(", 
               RowBox[{"Flatten", " ", "/@", " ", 
                RowBox[{"Transpose", "[", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"result", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Norm", "@", 
                    RowBox[{"Total", "[", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "k"}], "]"}], "]"}], "]"}]}], "&"}], "/@", 
                    RowBox[{
                    "result", "[", "\"\<ClosedPolygonUnitEdgeVectors\>\"", 
                    "]"}]}], ",", 
                    RowBox[{
                    "result", "[", "\"\<EdgeQuotientSpaceSamplingWeights\>\"",
                     "]"}]}], "}"}]}], "]"}], "@", 
                    RowBox[{"RandomClosedPolygons", "[", 
                    RowBox[{"3", ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", "n"}], "]"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{"1", ",", "n"}], "]"}], ",", 
                    RowBox[{"samplecount", "/", "10"}], ",", 
                    RowBox[{"\"\<ThreadCount\>\"", "->", "8"}]}], "]"}]}], 
                   ",", 
                   RowBox[{"{", "10", "}"}]}], "]"}], "]"}]}], ")"}], "]"}], 
             " ", ")"}], ")"}], "]"}], ")"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Histogram", "[", 
           RowBox[{
           "SampledChordData", ",", "\"\<FreedmanDiaconis\>\"", ",", 
            "\"\<PDF\>\"", ",", 
            RowBox[{"ChartStyle", "\[Rule]", 
             RowBox[{"Cols", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}]}], "]"}], ",", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"ChordPDF", "[", 
             RowBox[{"n", ",", "k", ",", "x"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "k"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", 
               RowBox[{"Cols", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Ticks", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"MaTeX", "[", 
                RowBox[{"\"\<\\\\mathbf{\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<}\>\""}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "0", ",", "k"}], "}"}]}], "]"}], ",", 
           "None"}], "}"}]}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{"xrange", ",", "yrange"}], "}"}]}], ",", 
        RowBox[{"AxesOrigin", "->", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"ImagePadding", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"50", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"30", ",", "30"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{"\"\<\\\\text{length of chord skipping } \>\"", "<>", 
               RowBox[{"ToString", "[", "k", "]"}], "<>", 
               "\"\< \\\\text{ edges in } \
\\\\widehat{\\\\operatorname{Pol}}_3(\>\"", "<>", 
               RowBox[{"ToString", "[", "n", "]"}], "<>", 
               "\"\<;\\\\vec{1})\>\""}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"1.1", 
                RowBox[{"yrange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], ",", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{"\"\<\\\\text{samples} = 10^\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Round", "[", 
                 RowBox[{"Log10", "[", "samplecount", "]"}], "]"}], "]"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"2", "/", "3"}], ")"}], 
                RowBox[{"Mean", "[", "xrange", "]"}]}], ",", 
               RowBox[{
                RowBox[{"-", "0.1"}], " ", 
                RowBox[{"yrange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"MaTeX", "[", 
              RowBox[{"\"\<\\\\text{time} = \>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"time", ",", "3"}], "]"}], "]"}], "<>", 
               "\"\< s\>\""}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"4", "/", "3"}], ")"}], 
                RowBox[{"Mean", "[", "xrange", "]"}]}], ",", 
               RowBox[{
                RowBox[{"-", "0.1"}], " ", 
                RowBox[{"yrange", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzltI2mEYx3GzmnMwOnlYf5lDmGUrFluDjQhWMCyKKBuT7ELDDpjZlgU2
NhgU2Sq8cEjLWkREbLMD1CpNoXmxm4xaB20IIRm0liDKDiCx+G//33vx8uGF
5+H5SrTP6lrYLBZLyjxoCHePZgSjZS9KbcQUo+sd+WfTHyFl/r0ARa2nTjh+
e8IHp9KCITjckHcCw9buH/CWuzEK5Ts6Glqm2emZjE+qLxOveWPXIX0cF0PZ
6pIUBri7ObCXIyiAr4SsIri9rr1P5hXKcmiijDXwk5uvgNIegzyL8e7sw8ew
4kxbDws552pYdeOtHhYN7RELHF+fwn1xWSf0WFUmGOJOvoT62mkzjDwQ2GAJ
d3ACTrr8RCq2OAUtP5NmYJ/INgc3aGqedJTyV+DzPY0L3myyfyZd92gv9Gcl
++BRbeU22R+L++EI3X5A7kWLQ6Qvt+0Y8tRfvsNm9kAE5i8ZE/DXcO4FXPn3
PoWHbl1/Knx0WJIBQzGJEMrEqisCRuelqqtw83U5D34L7Mrgn8VepZAx2GHo
gGsRXxcMu/hmaCl8M0I03bHDrU7HMlSOaTxQkrD9pRjn9B8u4H9EVS/N
  "],
 CellLabel->"In[35]:=",ExpressionUUID->"d24c7bd2-bd24-4083-8a02-4e8fb7104ce1"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8713791920593767`*^9, 3.8713791931584806`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"df1a77e8-90f7-4cba-8e0f-1f99f07a1e02"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<../../talks/100-gon-chord-50-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"Echo", "@", 
      RowBox[{"ChordlengthHistogram3DBig", "[", 
       RowBox[{"100", ",", "50", ",", 
        SuperscriptBox["10", "i"], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "15"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.2"}], "}"}]}], "}"}]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.871379201655066*^9, 3.871379209086969*^9}, {
   3.871379626196373*^9, 3.8713796279323387`*^9}, {3.871379984162764*^9, 
   3.871379989852106*^9}, {3.87138014683045*^9, 3.871380162309428*^9}, 
   3.871380262512864*^9, {3.871382177598494*^9, 3.871382189516568*^9}, {
   3.87138230928085*^9, 3.8713823112339563`*^9}, 3.871382432714806*^9, {
   3.871382502162569*^9, 3.871382503463402*^9}, 3.871382951990445*^9, 
   3.871383281224811*^9, {3.871383325956808*^9, 3.8713833275359917`*^9}, 
   3.871383384651807*^9, 3.871383526685122*^9, {3.8713836236689587`*^9, 
   3.871383634902834*^9}, {3.8713876962436733`*^9, 3.871387708643895*^9}, {
   3.8713905252461233`*^9, 3.871390530973276*^9}, {3.871390577805382*^9, 
   3.8713905945315866`*^9}, {3.871390773837364*^9, 3.871390856767817*^9}, {
   3.8713909179757147`*^9, 3.8713909183610277`*^9}, {3.87139719869401*^9, 
   3.871397202300045*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"62eba8e1-1ab9-4907-8cb1-eb2b7f96fad8"],

Cell[BoxData[
 RowBox[{"Histogram", "[", "d", "]"}]], "Input",
 CellChangeTimes->{{3.8713831279567957`*^9, 3.8713831627066174`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"4acc3b15-a2e9-459e-8412-e4328f79d6cc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.871382276889464*^9, 3.8713822869808903`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"38c314af-e7c1-4df8-afaa-4146a6326e1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Some new results in 5d!", "Section",
 CellChangeTimes->{{3.871391378622696*^9, 3.871391384302039*^9}, {
  3.871391507651897*^9, 3.871391508949849*^9}, {3.871391669853546*^9, 
  3.871391669879772*^9}},ExpressionUUID->"18a4021f-fc3e-4637-8b26-\
0b144571018c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RandomClosedPolygons", "[", 
   RowBox[{"10", ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"1", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"1", ",", "4"}], "]"}], ",", "10", ",", 
    RowBox[{"\"\<ThreadCount\>\"", "->", "8"}]}], "]"}], "[", 
  "\"\<EdgeSpaceSamplingWeights\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.871398185309585*^9, 3.871398359492277*^9}, {
  3.871398409598049*^9, 3.8713984434338512`*^9}, {3.871398680120934*^9, 
  3.871398684808838*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"058bec75-8ad5-40e2-b5d5-c6e4a3e4ad5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChordlengthHistogram5D", "[", 
   RowBox[{"n_", ",", "k_", ",", "samplecount_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"result", ",", "SampledChordData", ",", "time"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", ",", "result"}], "}"}], " ", "=", " ", 
      RowBox[{"AbsoluteTiming", "[", 
       RowBox[{"RandomClosedPolygons", "[", 
        RowBox[{"5", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", "n"}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"1", ",", "n"}], "]"}], ",", "samplecount", ",", 
         RowBox[{"\"\<ThreadCount\>\"", "->", "8"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SampledChordData", "=", " ", 
      RowBox[{"WeightedData", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "@", 
           RowBox[{"Total", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "k"}], "]"}], "]"}], "]"}]}], "&"}], "/@", 
         RowBox[{
         "result", "[", "\"\<ClosedPolygonUnitEdgeVectors\>\"", "]"}]}], ",", 
        
        RowBox[{
        "result", "[", "\"\<EdgeQuotientSpaceSamplingWeights\>\"", "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", "result", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Histogram", "[", 
         RowBox[{
         "SampledChordData", ",", "\"\<FreedmanDiaconis\>\"", ",", 
          "\"\<PDF\>\"", ",", 
          RowBox[{"ChartStyle", "\[Rule]", 
           RowBox[{"Cols", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}]}], "]"}], "}"}], ",", 
       RowBox[{"Ticks", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"MaTeX", "[", 
               RowBox[{"\"\<\\\\mathbf{\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<}\>\""}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", "None"}],
          "}"}]}], ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "k"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"AxesOrigin", "->", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"ImagePadding", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"30", ",", "30"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"\"\<\\\\text{length of chord skipping } \>\"", "<>", 
              RowBox[{"ToString", "[", "k", "]"}], "<>", 
              "\"\< \\\\text{ edges in } \
\\\\widehat{\\\\operatorname{Pol}}_{5}(\>\"", "<>", 
              RowBox[{"ToString", "[", "n", "]"}], "<>", 
              "\"\<;\\\\vec{1})\>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Left", ",", "Bottom"}], "}"}]}], "]"}], ",", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"\"\<\\\\text{samples} = 10^\>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"Log10", "[", "samplecount", "]"}], "]"}], "]"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"k", "/", "3"}], ",", 
              RowBox[{"-", "0.1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Inset", "[", 
           RowBox[{
            RowBox[{"MaTeX", "[", 
             RowBox[{"\"\<\\\\text{time} = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{"time", ",", "3"}], "]"}], "]"}], "<>", 
              "\"\< s\>\""}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"2", 
               RowBox[{"k", "/", "3"}]}], ",", 
              RowBox[{"-", "0.1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"Center", ",", "Top"}], "}"}]}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8713913759704533`*^9, 3.871391411285585*^9}, {
  3.8713914764455223`*^9, 3.8713914767843943`*^9}, {3.871391512620367*^9, 
  3.871391525088017*^9}, {3.87139157393851*^9, 3.8713917077977257`*^9}, {
  3.871391815454402*^9, 3.8713918480397263`*^9}, {3.871391908791814*^9, 
  3.8713919088516607`*^9}, {3.871391980975909*^9, 3.871391984375053*^9}, {
  3.871397879023726*^9, 3.871397888647479*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"84ebc8b1-02ab-48f9-839b-2ce52103df5c"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<../../talks/10-gon-chord-5-5d-\>\"", "<>", 
      RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<.pdf\>\""}], ",", 
     RowBox[{"Echo", "@", 
      RowBox[{"ChordlengthHistogram5D", "[", 
       RowBox[{"10", ",", "5", ",", 
        SuperscriptBox["10", "i"]}], "]"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3", ",", "7"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.871391760970626*^9, 3.871391793479391*^9}, {
  3.8713918615384827`*^9, 3.871391861587755*^9}, {3.871391915522131*^9, 
  3.8713919483717546`*^9}, {3.8713974076868553`*^9, 3.87139740876447*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"10713ce3-9446-4f2c-a825-04f199621f83"],

Cell[BoxData[
 RowBox[{"ChordlengthHistogram5D", "[", 
  RowBox[{"6", ",", "3", ",", "1000"}], "]"}]], "Input",
 CellChangeTimes->{{3.871391421526918*^9, 3.8713914987373533`*^9}, {
  3.87139153686884*^9, 3.8713915372520313`*^9}, {3.871391584308175*^9, 
  3.871391585268785*^9}, {3.87139162418467*^9, 3.871391625116056*^9}, {
  3.871391712797186*^9, 3.871391724185008*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"1a220a80-6ea5-40c9-b4f8-43fabc6ffc48"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Comparing results for chordlength distributions in ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SuperscriptBox[
        StyleBox["R", "TI"], 
        StyleBox["d", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "R^d", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "346e936f-3bc5-452c-a83d-b94e971f33f5"]
}], "Section",
 CellChangeTimes->{{3.8711091732202797`*^9, 3.8711092138475018`*^9}, 
   3.8711093282552023`*^9},ExpressionUUID->"3669533d-8b03-4d03-9078-\
62c1e037a919"],

Cell[TextData[{
 "Shonkwiler has provided a derivation of the PDF for the skip-",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["k", "TI"], TraditionalForm], "errors" -> {}, "input" -> "k", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "aa1538c3-6d7f-4c2a-882d-21e2f54b4a84"],
 " chordlength for an ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       StyleBox["n", "TI"], TraditionalForm], "errors" -> {}, "input" -> "n", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "440b0f98-1eef-4281-ad89-58078ca524a5"],
 "-gon in general dimension. This formula isn\[CloseCurlyQuote]t (yet) quite \
as satisfying as the ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["d", "TI"], "\[LongEqual]", "3"}], TraditionalForm], 
     "errors" -> {}, "input" -> "d=3", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "24c61cd8-a9a1-4795-9f65-8ce8e8a65500"],
 " case because it involves a numerical integration. But it does serve to \
compare our results against some known data."
}], "Text",
 CellChangeTimes->{{3.8711093301301517`*^9, 3.8711093610024776`*^9}, {
  3.8711095112497873`*^9, 
  3.871109569647201*^9}},ExpressionUUID->"43b2d414-68f8-449a-aa04-\
713e25eaa155"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "cnIntegrand", "]"}]], "Input",
 CellChangeTimes->{{3.871213862652862*^9, 3.871213866586233*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"03ac9f6c-fe8c-4627-b8e0-30dc92302e3d"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "cn", "]"}]], "Input",
 CellChangeTimes->{{3.871213868512144*^9, 3.8712138714719057`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"29cdccef-b806-4596-b3d0-08e7c065b059"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "=", "5"}], ",", "k", ",", "t", ",", "r"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"fkIntegrand", "[", 
       RowBox[{"d_", ",", "k_", ",", "t_", ",", "r_"}], "]"}], "=", 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["2", 
          RowBox[{"k", 
           RowBox[{"(", 
            FractionBox[
             RowBox[{"d", "-", "2"}], "2"], ")"}]}]], 
         SuperscriptBox[
          RowBox[{"Gamma", "[", 
           FractionBox["d", "2"], "]"}], "k"]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], 
          FractionBox["d", "2"]], 
         SuperscriptBox["t", 
          FractionBox[
           RowBox[{"d", "-", "2"}], "2"]]}]], 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BesselJ", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"d", "-", "2"}], "2"], ",", 
            RowBox[{"r", " ", "t"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{"BesselJ", "[", 
              RowBox[{
               FractionBox[
                RowBox[{"d", "-", "2"}], "2"], ",", "r"}], "]"}], 
             SuperscriptBox["r", 
              FractionBox[
               RowBox[{"d", "-", "2"}], "2"]]], ")"}], "k"], 
          SuperscriptBox["r", 
           FractionBox["d", "2"]]}], ",", 
         RowBox[{
          RowBox[{"d", ">=", "2"}], "&&", 
          RowBox[{"k", ">=", "1"}], "&&", 
          RowBox[{"r", ">", "0"}], "&&", 
          RowBox[{"t", ">", "0"}]}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cnIntegrand", "[", 
       RowBox[{
       "d_", ",", "k_", ",", "\[Rho]_", ",", "n_", ",", "r1_", ",", "r2_"}], 
       "]"}], " ", "=", " ", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fkIntegrand", "[", 
             RowBox[{"d", ",", "k", ",", "\[Rho]", ",", "r1"}], "]"}], 
            RowBox[{"fkIntegrand", "[", 
             RowBox[{"d", ",", 
              RowBox[{"n", "-", "k"}], ",", "\[Rho]", ",", "r2"}], "]"}], 
            SuperscriptBox["\[Rho]", 
             RowBox[{"d", "-", "1"}]]}], ",", 
           RowBox[{
            RowBox[{"d", ">=", "2"}], "&&", 
            RowBox[{"\[Rho]", ">", "0"}], "&&", 
            RowBox[{"r1", ">", "1"}], "&&", 
            RowBox[{"r2", ">", "0"}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", "0", ",", "k"}], "}"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cn", "[", 
       RowBox[{"d_", ",", "n_", ",", "k_"}], "]"}], ":=", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         SuperscriptBox["\[Pi]", 
          RowBox[{"d", "/", "2"}]]}], 
        RowBox[{"Gamma", "[", 
         RowBox[{"d", "/", "2"}], "]"}]], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{"cnIntegrand", "[", 
          RowBox[{
          "d", ",", "k", ",", "\[Rho]", ",", "n", ",", "r1", ",", "r2"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", "0", ",", 
           RowBox[{"Min", "[", 
            RowBox[{"k", ",", 
             RowBox[{"n", "-", "k"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r1", ",", "0", ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"r2", ",", "0", ",", "r1"}], "}"}], ",", 
         RowBox[{"Method", "->", "\"\<LocalAdaptive\>\""}]}], "]"}]}]}], 
     ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8711096057826567`*^9, 3.8711096062698393`*^9}, {
   3.871109663187232*^9, 3.871109663577894*^9}, 3.871109735276988*^9, 
   3.8712131349943857`*^9, {3.871213261248386*^9, 3.87121331601234*^9}, 
   3.871213366267837*^9, {3.8712133991018143`*^9, 3.871213403731089*^9}, {
   3.871213497430893*^9, 3.871213555763465*^9}, {3.871213596440441*^9, 
   3.871213613863092*^9}, {3.871213695307435*^9, 3.871213696406398*^9}, {
   3.8712137627381887`*^9, 3.871213845171809*^9}, {3.871213974906863*^9, 
   3.871213994527466*^9}, {3.8712140471384068`*^9, 3.871214052983132*^9}, {
   3.871214265026349*^9, 3.871214328197826*^9}, {3.871214370956203*^9, 
   3.871214377792795*^9}, {3.871214424789896*^9, 3.871214503199361*^9}, {
   3.87121466975399*^9, 3.8712146956218863`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"e3f4b48e-ce9a-469f-a238-fa4fc9640353"],

Cell[BoxData[
 RowBox[{"??", "cnIntegrand"}]], "Input",
 CellChangeTimes->{{3.871213666852394*^9, 3.871213667793573*^9}, {
  3.871213915809372*^9, 3.871213928281671*^9}, {3.8712140902480173`*^9, 
  3.871214093402955*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"1b77675f-536b-4f8c-83f1-820d14fe1651"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n5k2d3pts2", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", "5"}], ",", 
       RowBox[{"c5", "=", 
        RowBox[{"N", "[", 
         RowBox[{"cn", "[", 
          RowBox[{"3", ",", "5", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"4", "\[Pi]", " ", 
             SuperscriptBox["\[Rho]", "2"]}], "c5"], 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"FullSimplify", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fkIntegrand", "[", 
                 RowBox[{"d", ",", "k", ",", "\[Rho]", ",", "r1"}], "]"}], 
                RowBox[{"fkIntegrand", "[", 
                 RowBox[{"d", ",", 
                  RowBox[{"n", "-", "k"}], ",", "\[Rho]", ",", "r2"}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"d", ">=", "2"}], "&&", 
                RowBox[{"\[Rho]", ">", "0"}], "&&", 
                RowBox[{"r1", ">", "0"}], "&&", 
                RowBox[{"r2", ">", "0"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"r1", ",", "0", ",", "Infinity"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"r2", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", ".05", ",", "2", ",", ".05"}], "}"}]}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.879590968040896*^9, 3.879590968320764*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"2d9e2f85-73d2-4d5a-a14b-8631c68c96b0"],

Cell[BoxData[
 RowBox[{"Re", " ", "/@", " ", "n5k2d3pts2"}]], "Input",
 CellChangeTimes->{{3.871109703725835*^9, 3.8711097148141117`*^9}, {
  3.871213168064249*^9, 3.871213179459085*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"e7db3fa1-33ae-4bde-97c5-28bf4f9bda57"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.5 Inherited,
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e6065f90-3c16-413d-b7b1-a9de6ad048b8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 185, 3, 299, "Title",ExpressionUUID->"3ecf1c72-14b9-4a08-a317-e8d7b3693bc4"],
Cell[768, 27, 386, 8, 106, "Text",ExpressionUUID->"5798f9b8-63da-4821-af98-7aa30d997ea2"],
Cell[1157, 37, 108, 1, 49, "Input",ExpressionUUID->"9d02376a-18f9-4c6c-8b18-59580cdd602c"],
Cell[CellGroupData[{
Cell[1290, 42, 166, 3, 126, "Section",ExpressionUUID->"3e6f1aba-91a1-40fc-aacf-e8cc2e4619d4"],
Cell[1459, 47, 427, 9, 106, "Text",ExpressionUUID->"0d7203f6-405f-4a43-80db-9f4f57266304"],
Cell[1889, 58, 485, 11, 81, "Input",ExpressionUUID->"85342e5f-8dca-4a40-9649-89324f31daa0"],
Cell[2377, 71, 176, 3, 64, "Text",ExpressionUUID->"522eb636-2fa5-4264-916b-52c77375c948"],
Cell[2556, 76, 208, 3, 49, "Input",ExpressionUUID->"094cd658-2cf0-45ad-9a48-52ec18f49d1a"],
Cell[2767, 81, 287, 6, 64, "Text",ExpressionUUID->"f1b5ed18-bb2e-4474-aac2-ea49ab769dfb"],
Cell[3057, 89, 265, 6, 64, "Text",ExpressionUUID->"089ee0b0-5cd1-49d9-828e-4f143999f415"],
Cell[3325, 97, 7739, 194, 767, "Text",ExpressionUUID->"d5e4232f-fdb0-4ebd-a287-4d521830d396"],
Cell[11067, 293, 839, 22, 66, "Text",ExpressionUUID->"9c24e67f-027c-46bd-85f7-54fd8e62e725"],
Cell[11909, 317, 430, 9, 148, "Text",ExpressionUUID->"93cc0095-b353-44d4-afdf-cd3cd9ccf4fd"],
Cell[12342, 328, 935, 25, 81, "Input",ExpressionUUID->"da2afddb-2faf-464d-8a3d-4e14716aced5"],
Cell[13280, 355, 400, 9, 49, "Input",ExpressionUUID->"e1667daa-f5f3-444b-9727-98d099a2d670"],
Cell[13683, 366, 213, 4, 64, "Text",ExpressionUUID->"744483b5-870d-4d14-877b-a80d302e2ef9"],
Cell[13899, 372, 749, 17, 81, "Input",ExpressionUUID->"887a1e45-4875-439c-bd27-75defc8bfd4a"],
Cell[14651, 391, 214, 5, 64, "Text",ExpressionUUID->"9c53d308-9055-41b1-b77d-d9e88734b188"],
Cell[14868, 398, 136, 2, 49, "Input",ExpressionUUID->"e86808f2-3dd9-4f69-8ee5-2211d4adac8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15041, 405, 219, 5, 126, "Section",ExpressionUUID->"0163a8b1-7b3f-463f-bc9f-d65f585d589b"],
Cell[15263, 412, 309, 6, 106, "Text",ExpressionUUID->"48e1939d-0882-4f80-b802-bc4c21ff509e"],
Cell[15575, 420, 264, 4, 49, "Input",ExpressionUUID->"83ce48d2-2bb5-4d86-9665-dd958b131128"],
Cell[15842, 426, 7729, 231, 701, "Input",ExpressionUUID->"534808c9-4241-4f43-8a30-8472a82631ab"],
Cell[23574, 659, 326, 7, 106, "Text",ExpressionUUID->"83447d6f-52a3-4252-9484-2022949e85f5"],
Cell[23903, 668, 928, 28, 137, "Input",ExpressionUUID->"4e892c87-1f18-4b2a-a001-efb27e9ba24e"],
Cell[24834, 698, 194, 3, 49, "Input",ExpressionUUID->"794170e6-26e6-4517-bf25-8239fe1ab573"],
Cell[25031, 703, 1404, 31, 298, "Input",ExpressionUUID->"2d18e6e8-0764-491c-b184-de0ccf8e98ec",
 CellID->960905662],
Cell[26438, 736, 864, 22, 112, "Input",ExpressionUUID->"2a0be4ee-b1c9-4a0e-97d9-cab350018c6c"],
Cell[27305, 760, 228, 4, 49, "Input",ExpressionUUID->"3055acfb-3c61-44d7-9b3a-d5f69289eb44"],
Cell[27536, 766, 1279, 32, 112, "Input",ExpressionUUID->"850099b1-0feb-4356-aaf0-9506956e862e"],
Cell[28818, 800, 5995, 153, 701, "Input",ExpressionUUID->"f80c6cd6-babb-489f-8c0a-63187608cfe6"],
Cell[34816, 955, 1063, 22, 99, "Input",ExpressionUUID->"f5f50780-3dfb-434f-8400-26e660bd981d"],
Cell[35882, 979, 825, 18, 99, "Input",ExpressionUUID->"3b2551c1-7415-47a6-81ad-13e19c32def7"],
Cell[36710, 999, 828, 18, 99, "Input",ExpressionUUID->"aa790d26-8fff-4097-afd5-7f1fab99881c"],
Cell[37541, 1019, 7756, 184, 794, "Input",ExpressionUUID->"d24c7bd2-bd24-4083-8a02-4e8fb7104ce1"],
Cell[45300, 1205, 175, 2, 49, "Input",ExpressionUUID->"df1a77e8-90f7-4cba-8e0f-1f99f07a1e02"],
Cell[45478, 1209, 1723, 34, 130, "Input",ExpressionUUID->"62eba8e1-1ab9-4907-8cb1-eb2b7f96fad8"],
Cell[47204, 1245, 211, 3, 49, "Input",ExpressionUUID->"4acc3b15-a2e9-459e-8412-e4328f79d6cc"],
Cell[47418, 1250, 173, 2, 49, "Input",ExpressionUUID->"38c314af-e7c1-4df8-afaa-4146a6326e1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47628, 1257, 263, 4, 126, "Section",ExpressionUUID->"18a4021f-fc3e-4637-8b26-0b144571018c"],
Cell[47894, 1263, 616, 13, 81, "Input",ExpressionUUID->"058bec75-8ad5-40e2-b5d5-c6e4a3e4ad5c"],
Cell[48513, 1278, 5388, 134, 670, "Input",ExpressionUUID->"84ebc8b1-02ab-48f9-839b-2ce52103df5c"],
Cell[53904, 1414, 831, 18, 99, "Input",ExpressionUUID->"10713ce3-9446-4f2c-a825-04f199621f83"],
Cell[54738, 1434, 451, 7, 49, "Input",ExpressionUUID->"1a220a80-6ea5-40c9-b4f8-43fabc6ffc48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55226, 1446, 573, 14, 128, "Section",ExpressionUUID->"3669533d-8b03-4d03-9078-62c1e037a919"],
Cell[55802, 1462, 1395, 33, 152, "Text",ExpressionUUID->"43b2d414-68f8-449a-aa04-713e25eaa155"],
Cell[57200, 1497, 216, 3, 49, "Input",ExpressionUUID->"03ac9f6c-fe8c-4627-b8e0-30dc92302e3d"],
Cell[57419, 1502, 209, 3, 49, "Input",ExpressionUUID->"29cdccef-b806-4596-b3d0-08e7c065b059"],
Cell[57631, 1507, 4814, 122, 778, "Input",ExpressionUUID->"e3f4b48e-ce9a-469f-a238-fa4fc9640353"],
Cell[62448, 1631, 300, 5, 49, "Input",ExpressionUUID->"1b77675f-536b-4f8c-83f1-820d14fe1651"],
Cell[62751, 1638, 1844, 47, 406, "Input",ExpressionUUID->"2d9e2f85-73d2-4d5a-a14b-8631c68c96b0"],
Cell[64598, 1687, 266, 4, 49, "Input",ExpressionUUID->"e7db3fa1-33ae-4bde-97c5-28bf4f9bda57"]
}, Open  ]]
}, Open  ]]
}
]
*)

