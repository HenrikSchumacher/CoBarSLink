Notebook[{
Cell[BoxData["Exit"], "Input",
 CellChangeTimes->{{3.873864239407578*^9, 3.8738642403220377`*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"e900fb1a-6400-48b5-9ddb-415fcad81665"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{"LibraryFunctionUnload", "[", 
      RowBox[{"CoBarSLink`Private`cDouadyEarleExtension", "[", "3", "]"}], 
      "]"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Quiet", "[", 
     RowBox[{"LibraryFunctionUnload", "[", 
      RowBox[{"CoBarSLink`Private`cDouadyEarleExtension", "[", "4", "]"}], 
      "]"}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Get", "[", "\[IndentingNewLine]", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
       "\"\<CoBarSLink.m\>\""}], "}"}], "]"}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoBarSLink`Private`clearLibraries", "[", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"cE3", "=", 
     RowBox[{"CoBarSLink`Private`cDouadyEarleExtension", "[", "3", "]"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"cE4", "=", 
    RowBox[{"CoBarSLink`Private`cDouadyEarleExtension", "[", "4", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"a14e8661-385b-49e8-846a-93b79486cbef"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Compiling cDouadyEarleExtension[4]...\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"c581d9d2-1b8d-4fdc-be1a-bf336785cce4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reading build settings from \"\>", 
   "\[InvisibleSpace]", \
"\<\"/Users/Henrik/github/CoBarsLink/LibraryResources/Source/BuildSettings.m\"\
\>"}],
  SequenceForm[
  "Reading build settings from ", 
   "/Users/Henrik/github/CoBarsLink/LibraryResources/Source/BuildSettings.m"],
  
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"4ade86ce-76a1-4f38-8f6d-fce65ed0b8ef"],

Cell[BoxData["\<\"\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"5f33b669-bb88-48c1-a40e-6de5bc556120"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Compilation done. Time elapsed = \"\>", "\[InvisibleSpace]", 
   "3.496057`", "\[InvisibleSpace]", "\<\" s.\\n\"\>"}],
  SequenceForm["Compilation done. Time elapsed = ", 3.496057, " s.\n"],
  Editable->False]], "Print",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"53777832-268f-4a1d-9c71-4e23b7ef4421"]
}, Open  ]],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["LibraryFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Function name: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"DouadyEarleExtension\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Function name: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["\"DouadyEarleExtension\"", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["5", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Real", ",", "2", ",", "\"Constant\""}], "}"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"Real", ",", "2", ",", "\"Constant\""}], "}"}], 
                    ",", "Integer", ",", "Integer", ",", 
                    RowBox[{"True", "|", "False"}]}], "}"}], 
                   ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 0, 
                   StripOnInput -> True], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Return type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"{", 
                    RowBox[{"Real", ",", "2"}], "}"}], 
                   ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 0, 
                   StripOnInput -> True], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Library: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                 "\"DouadyEarleExtension_4D.dylib\"", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  LibraryFunction[
  "/Users/Henrik/github/CoBarsLink/LibraryResources/MacOSX-ARM64/\
DouadyEarleExtension_4D.dylib", 
   "DouadyEarleExtension", {{Real, 2, "Constant"}, {Real, 2, "Constant"}, 
    Integer, Integer, 
    Alternatives[True, False]}, {Real, 2}],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellLabel->"Out[4]=",ExpressionUUID->"89de1a40-ca02-4d2d-9afa-8d02f1fd4936"]
}, Open  ]],

Cell[BoxData[""], \
"Input",ExpressionUUID->"5d79b668-630f-446c-bcd7-a505b4e68aec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "32"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "10000000"}], ";"}]}], "Input",
 CellLabel->"In[17]:=",ExpressionUUID->"1e3734a0-5110-4ed8-997c-d4367d2ef248"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", 
    RowBox[{"RandomOpenPolygons", "[", 
     RowBox[{"2", ",", "n", ",", "m"}], "]"}]}], ";"}], "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", 
    RowBox[{"RandomClosedPolygons", "[", 
     RowBox[{"2", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1.", ",", "n"}], "]"}], ",", "m"}], "]"}]}], ";"}], "//", 
  "RepeatedTiming"}]}], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"b34395dc-eb0f-4512-8fc7-af7416532f0d"],

Cell[BoxData[
 RowBox[{"?", "RandomClosedPolygons"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"3e30320e-2579-4cd2-84da-de18a3c4e494"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PM`\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"UninstallPackages", "[", 
     RowBox[{"$PM", ",", 
      RowBox[{"{", "\"\<RepulsorLink\>\"", "}"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LoadPackages", "[", 
     RowBox[{"{", "\"\<RepulsorLink\>\"", "}"}], "]"}], ";"}], "//", 
   "AbsoluteTiming"}], "//", 
  "First"}]}], "Input",ExpressionUUID->"f3a25726-a04b-4110-9cf1-b651250baac1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", 
    RowBox[{"1024", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"ScaleToLength", "[", 
      RowBox[{
       RowBox[{"TorusKnot", "[", 
        RowBox[{"5", ",", "2", ",", 
         RowBox[{"Mesh", "->", "n"}]}], "]"}], ",", "1."}], "]"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"ScaleToLength", "[", 
       RowBox[{
        RowBox[{"Knot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"9", ",", "35"}], "}"}], ",", 
          RowBox[{"Mesh", "->", "n"}]}], "]"}], ",", "1."}], "]"}], "]"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"ScaleToLength", "[", 
     RowBox[{
      RowBox[{"Knot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "1"}], "}"}], ",", 
        RowBox[{"Mesh", "->", "n"}]}], "]"}], ",", "1."}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetRandomVectorSmoothingParameter", "[", 
   RowBox[{"P", ",", 
    RowBox[{"0.01", "/", "2"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"Displace", "[", 
    RowBox[{"P", ",", 
     RowBox[{"0.05", 
      RowBox[{"SmoothedRandomVector", "[", "P", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TubePlot", "[", "P", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disk", "=", 
   RowBox[{"DiskMesh", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StereoInverse", "=", 
   RowBox[{"Y", "\[Function]", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"2", 
       RowBox[{"Y", "/", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"Y", ".", "Y"}]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Y", ".", "Y"}], "-", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Y", ".", "Y"}], "+", "1"}], ")"}]}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Stereo", "=", 
   RowBox[{"X", "\[Function]", 
    RowBox[{
     RowBox[{"X", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "2"}]}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{"-", "1"}], "]"}], "]"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curve4D", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"StereoInverse", ",", 
     RowBox[{"VertexCoordinates", "[", "P", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"surf4D", "=", 
    RowBox[{"Init", "[", 
     RowBox[{"mesh", ",", 
      RowBox[{"cE4", "[", 
       RowBox[{"curve4D", ",", 
        RowBox[{"VertexCoordinates", "[", "disk", "]"}], ",", "n", ",", "8", 
        ",", "False"}], "]"}], ",", 
      RowBox[{"Triangles", "[", "disk", "]"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"3f022b54-74de-42d7-95b3-17ca38d75a16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Map", "[", 
    RowBox[{"Stereo", ",", "surf4D"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"Repulsor", "[", "surf4D", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"BlockClusterMatrices", "[", "R", "]"}], "[", 
    "\"\<Intersection\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{
    RowBox[{"PrimitiveOrdering", "[", "R", "]"}], "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"intersections", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{"Sort", "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"UpperTriangularize", "[", "A", "]"}], "[", 
          "\"\<NonzeroPositions\>\"", "]"}], "]"}], "]"}], "]"}], ",", "2"}], 
     "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intersectingtriangles", "=", 
   RowBox[{"Union", "@@", "intersections"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "intersections", "]"}]}], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"545d11e2-db5c-4f1c-88ed-f7e324d45ba4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tris", "=", 
   RowBox[{"TriangleData", "[", "surf4D", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j"}], "}"}], "=", 
   RowBox[{"Transpose", "[", "intersections", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", "=", 
   RowBox[{"(", 
    RowBox[{"Transpose", "@", 
     RowBox[{"cNormalize", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "2"}], "]"}], "]"}], "-", 
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{"tris", "[", 
          RowBox[{"[", 
           RowBox[{"j", ",", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
       "}"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Det", "/@", "frames"}], "\[IndentingNewLine]", 
 RowBox[{"colors", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Orange", ",", "unigreen"}], "}"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Sign", "[", 
         RowBox[{"Det", "/@", "frames"}], "]"}]}], ")"}], "/", "2"}]}], "]"}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MeshPlot", "[", "M", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"TriangleHighlight", "[", 
     RowBox[{"M", ",", "intersectingtriangles", ",", 
      RowBox[{"PlotStyle", "->", "Yellow"}]}], "]"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Specularity", "[", 
       RowBox[{"White", ",", "30"}], "]"}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"colors", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Sphere", "[", 
            RowBox[{"#", ",", "0.002"}], "]"}], "&"}], "/@", 
          RowBox[{
           RowBox[{"TriangleMidpoints", "[", "M", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], "]"}]}], "}"}], "]"}]}],
   "\[IndentingNewLine]", "]"}]}], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"e125416c-d40c-4ae5-bc23-fb94b6755023"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "surf4D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tridata", "=", 
   RowBox[{"TriangleData", "[", "\[CapitalSigma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cG", "=", 
   RowBox[{"cGJK", "[", 
    RowBox[{"4", ",", "3", ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0.", ",", "4"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Adj", "=", 
    RowBox[{
     RowBox[{"AdjacencyMatrix", "[", 
      RowBox[{"\[CapitalSigma]", ",", "Triangles", ",", "Vertices"}], "]"}], 
     ".", 
     RowBox[{"AdjacencyMatrix", "[", 
      RowBox[{"\[CapitalSigma]", ",", "Vertices", ",", "Triangles"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inter", "=", 
    RowBox[{"Sort", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "=", 
            RowBox[{"tridata", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Adj", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", "0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Q", "=", 
                 RowBox[{"tridata", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"r2", "=", 
                 RowBox[{"cG", "[", 
                  RowBox[{"P", ",", "x", ",", "Q", ",", "y"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"r2", "<", 
                   RowBox[{"10", "$MachineEpsilon"}]}], ",", 
                  RowBox[{"Sow", "[", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"i", "+", "1"}], ",", 
               RowBox[{"Length", "[", "tridata", "]"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "tridata", "]"}]}], "}"}]}], "]"}], 
        "\[IndentingNewLine]", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"inter", "==", 
  "intersections"}]}], \
"Input",ExpressionUUID->"13c48685-b98c-48d9-b4ba-19c04b4a3096"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"7080b105-4568-4164-8151-82b770d730f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[CapitalSigma]", "=", "surf4D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tridata", "=", 
   RowBox[{"TriangleData", "[", "\[CapitalSigma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"corners", "=", 
   RowBox[{"tridata", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tridata", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "-", "corners"}], ",", 
      RowBox[{
       RowBox[{"tridata", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "3"}], "]"}], "]"}], "-", "corners"}]}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Adj", "=", 
    RowBox[{
     RowBox[{"AdjacencyMatrix", "[", 
      RowBox[{"\[CapitalSigma]", ",", "Triangles", ",", "Vertices"}], "]"}], 
     ".", 
     RowBox[{"AdjacencyMatrix", "[", 
      RowBox[{"\[CapitalSigma]", ",", "Vertices", ",", "Triangles"}], 
      "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", "i", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inter", "=", 
   RowBox[{
    RowBox[{"Reap", "[", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"bi", "=", 
         RowBox[{"corners", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fi", "=", 
         RowBox[{"frames", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Adj", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"A", "=", 
              RowBox[{"Transpose", "[", 
               RowBox[{"Join", "[", 
                RowBox[{"fi", ",", 
                 RowBox[{"-", 
                  RowBox[{"frames", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"b", "=", 
              RowBox[{
               RowBox[{"corners", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "-", "bi"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"\[Lambda]", "=", 
              RowBox[{"LinearSolve", "[", 
               RowBox[{"A", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{
                    RowBox[{"A", ".", "\[Lambda]"}], "-", "b"}], "]"}], "<=", 
                  
                  RowBox[{"100", "$MachineEpsilon"}]}], ")"}], "&&"}], "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"0", "<=", 
                  RowBox[{"Min", "[", "\[Lambda]", "]"}]}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Max", "[", "\[Lambda]", "]"}], "<=", "1"}], ")"}], 
                "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", 
                   RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "<=", "1"}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", 
                   RowBox[{"\[Lambda]", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "<=", "1"}], ")"}]}], 
               ",", 
               RowBox[{"Sow", "[", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], "]"}]}], "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"i", "+", "1"}], ",", 
            RowBox[{"Length", "[", "tridata", "]"}]}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "tridata", "]"}]}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], 
  ";"}]}], "Input",ExpressionUUID->"d659d1e5-3a07-483e-8639-d7136120e449"],

Cell[BoxData[
 RowBox[{"inter", "//", "Length"}]], "Input",
 CellLabel->
  "In[139]:=",ExpressionUUID->"7ec52840-cc15-473c-8511-b6a8ed8152b2"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"b1f1e8be-574b-4501-82fe-501c99dee471"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j"}], "}"}], "=", "e"}], ";", "\[IndentingNewLine]", 
    
    RowBox[{"bi", "=", 
     RowBox[{"corners", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"fi", "=", 
     RowBox[{"frames", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"A", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Join", "[", 
       RowBox[{"fi", ",", 
        RowBox[{"-", 
         RowBox[{"frames", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"b", "=", 
     RowBox[{
      RowBox[{"corners", "[", 
       RowBox[{"[", "j", "]"}], "]"}], "-", "bi"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Lambda]", "=", 
     RowBox[{"LinearSolve", "[", 
      RowBox[{"A", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Det", "[", 
     RowBox[{"Normalize", "/@", "A"}], "]"}]}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"e", ",", "inter"}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[499]:=",ExpressionUUID->"a0d20e9b-9e0f-493d-9fd2-b70fb1dea32c"],

Cell[BoxData[
 RowBox[{"inter\[CapitalSigma]", "//", "Length"}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"0a0d834a-8f64-49d3-89e8-757db2443a6b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"Repulsor", "[", "\[CapitalSigma]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"PrimitiveOrdering", "[", "R", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inter\[CapitalSigma]", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BlockClusterMatrices", "[", "R", "]"}], "[", 
           "\"\<VeryNear\>\"", "]"}], "[", "\"\<NonzeroPositions\>\"", "]"}], 
         "]"}], "]"}], "]"}], "+", "1"}], ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FaceForm", "[", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"ToGraphicsComplex3D", "[", "\[CapitalSigma]", "]"}]}], 
     "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"GridMeshPlot", "[", 
      RowBox[{"\[CapitalSigma]", ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Opacity", "[", "0.5", "]"}]}]}], "]"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TriangleHighlight", "[", 
    RowBox[{"M", ",", 
     RowBox[{"Union", "@@", "inter\[CapitalSigma]"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Lighting", "->", "\"\<Neutral\>\""}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"ed1b9113-963b-4f64-a7a3-396553a298e6"],

Cell[BoxData[""], "Input",
 CellLabel->"In[72]:=",ExpressionUUID->"ac0e5878-e321-4350-9a99-e59516f649d3"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"5def4d17-960e-4911-892d-d41198577b77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"i", ",", "j"}], "}"}], "=", 
  RowBox[{"inter", "[", 
   RowBox[{"[", "11", "]"}], "]"}]}]], "Input",
 CellLabel->"In[89]:=",ExpressionUUID->"e2688b5d-7b07-4172-918c-fbfae01d5ef3"],

Cell[BoxData[
 RowBox[{"corners", "[", 
  RowBox[{"[", "i", "]"}], "]"}]], "Input",
 CellLabel->"In[90]:=",ExpressionUUID->"9720d79c-f8c2-4ef7-8323-290d46ef96c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bi", "=", 
   RowBox[{"corners", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fi", "=", 
   RowBox[{"frames", "[", 
    RowBox[{"[", "i", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"fi", ",", 
      RowBox[{"-", 
       RowBox[{"frames", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{
    RowBox[{"corners", "[", 
     RowBox[{"[", "j", "]"}], "]"}], "-", "bi"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]", "=", 
  RowBox[{"LinearSolve", "[", 
   RowBox[{"A", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{
   RowBox[{"A", ".", "\[Lambda]"}], "-", "b"}], "]"}]}], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"90c410d3-f76f-49f4-9937-6eb280a38f91"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"be99d13d-2432-40b7-8a50-7ef3c7aa63f7"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"90c80d00-2667-49b0-a877-df03283b4c4a"],

Cell[BoxData["fi"], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"7ff9e00b-1eaa-43e6-afd2-677021d994b3"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"FaceForm", "[", "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ToGraphicsComplex3D", "[", "\[CapitalSigma]", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FaceForm", "[", "unigreen", "]"}]}], "\[IndentingNewLine]", 
     "}"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"GridMeshPlot", "[", 
      RowBox[{"\[CapitalSigma]", ",", 
       RowBox[{"PlotStyle", "->", 
        RowBox[{"Opacity", "[", "0.5", "]"}]}]}], "]"}], ","}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"TriangleHighlight", "[", 
    RowBox[{"M", ",", 
     RowBox[{"Flatten", "@", "inter"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellLabel->
  "In[130]:=",ExpressionUUID->"b744307a-dea2-4fb9-a10e-c8b5cc1bc6cb"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Adj", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "==", "0"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"A", ".", "\[Lambda]"}], "-", "b"}], "]"}], "<=", 
           RowBox[{"100", "$MachineEpsilon"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{"0", "<=", 
           RowBox[{"Min", "[", "\[Lambda]", "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Max", "[", "\[Lambda]", "]"}], "<=", "1"}], ")"}]}], ",", 
        
        RowBox[{"Sow", "[", 
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "]"}]}], "]"}], 
      ";"}]}]}]}]}]], \
"Input",ExpressionUUID->"0ec7e1f6-e069-429b-9e51-78aca54d20c5"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"22ed1edc-db55-4f04-a19c-6e7356125645"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"adc43cbe-196f-4e29-b37e-28d50e17d0a8"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"430b06cb-c6f2-42a6-ac9f-3c77909605fa"],

Cell[BoxData[
 RowBox[{"SingularValueList", "[", "A", "]"}]], "Input",
 CellLabel->
  "In[202]:=",ExpressionUUID->"d3422342-281b-416a-8e04-b3784d5371d8"],

Cell[BoxData[
 RowBox[{"A", "//", "Det"}]], "Input",
 CellLabel->
  "In[183]:=",ExpressionUUID->"3fc3f0ff-7063-4f19-96b9-d1bd6f785e33"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"15e80c4b-305f-4382-bcd1-6096b8760ba1"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"7912c15f-6330-4e7e-9d17-ba6ccec4c326"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"43660395-5c49-479c-8df5-a7b1cff6c555"],

Cell[BoxData[
 RowBox[{"franmes", 
  "="}]], "Input",ExpressionUUID->"19bb29d2-0092-4049-9a81-b7f218503d91"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"effce985-ffba-435e-ab0c-457474ff347a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1.", "-", 
    RowBox[{"1", "/", 
     RowBox[{"n", "^", "2"}]}]}], ")"}], "^", "32"}]}], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"1b8fa3fe-862e-45c3-a8bc-bda89bcdb520"],

Cell[BoxData[{
 RowBox[{"1.", "/", 
  RowBox[{"n", "^", "2"}]}], "\[IndentingNewLine]", 
 RowBox[{"1", "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1.", "-", 
     RowBox[{"1", "/", 
      RowBox[{"n", "^", "2"}]}]}], ")"}], "^", "32"}]}]}], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"c444d56e-150a-4eaa-b7bd-3138dfb97cff"],

Cell[BoxData[
 RowBox[{"(", 
  RowBox[{"1.", "-", 
   RowBox[{"1", "/", 
    RowBox[{"n", "^", "2"}]}]}], ")"}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"959ef2b2-6397-4e21-a557-b6728d648f03"],

Cell[BoxData["Exit"], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"1115cb37-b99c-4a56-a07f-5679b08b99ea"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Needs", "[", "\"\<PM`\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"UninstallPackages", "[", 
     RowBox[{"$PM", ",", 
      RowBox[{"{", "\"\<RepulsorLink\>\"", "}"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LoadPackages", "[", 
     RowBox[{"{", "\"\<RepulsorLink\>\"", "}"}], "]"}], ";"}], "//", 
   "AbsoluteTiming"}], "//", "First"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"5e2d4a06-ac28-4823-8766-7c5d90433c9d"],

Cell[BoxData["\<\"WARNING: LTemplate has not yet been tested with Mathematica \
13.2.1.\\nThe latest supported Mathematica version is 12.3.1.\\nPlease report \
any issues you find to szhorvat at gmail.com.\"\>"], "Print",
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"85f24493-8415-4a33-9e86-a522b512fdd8"],

Cell[BoxData["1.626665`"], "Output",
 CellLabel->"Out[6]=",ExpressionUUID->"87db0c53-9e28-41a3-a8d4-4f4b24e879d3"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", "\[IndentingNewLine]", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ParentDirectory", "[", 
       RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
      "\"\<CoBarSLink.m\>\""}], "}"}], "]"}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoBarSLink`Private`clearLibraries", "[", "]"}], ";"}]}], "Input",
 CellLabel->"In[5]:=",ExpressionUUID->"50d73509-a7eb-42a3-98d9-0f1bdbec4693"],

Cell[BoxData[
 RowBox[{"?", "ActionAngleSample"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"9c6c4ffc-691d-42f3-843d-3a8d798676d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"Length", "/@", 
       RowBox[{"Nearest", "[", 
        RowBox[{
         RowBox[{"#", "->", "\"\<Index\>\""}], ",", "#", ",", 
         RowBox[{"{", 
          RowBox[{"\[Infinity]", ",", 
           RowBox[{"1.", "+", 
            RowBox[{"4", "$MachineEpsilon"}]}]}], "}"}]}], "]"}]}], "]"}], "<=",
      "3"}], "&"}]}], ";"}]], "Input",
 CellLabel->"In[7]:=",ExpressionUUID->"a15603a0-a49c-4dad-91cd-27297d6711c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cf", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"threshold", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1.", "+", 
          RowBox[{"4", "$MachineEpsilon"}]}], ")"}], "^", "2"}]}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"X", ",", "_Real", ",", "2"}], "}"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "xi", ",", "yi", ",", "zi", ",", "xj", ",", "yj", ",", "zj", ",", 
           "r2", ",", "counter", ",", "i", ",", "j", ",", "n"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"counter", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"Length", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "<=", "n"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"counter", "<=", "0"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xi", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"X", ",", "i", ",", "1"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"yi", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"X", ",", "i", ",", "2"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"zi", "=", 
              RowBox[{"Compile`GetElement", "[", 
               RowBox[{"X", ",", "i", ",", "3"}], "]"}]}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"counter", "=", "0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "<=", "n"}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{"counter", "<=", "0"}], ")"}]}], ",", 
               "\[IndentingNewLine]", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"i", "-", "j"}], "]"}], ",", 
                    RowBox[{"n", "-", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"i", "-", "j"}], "]"}]}]}], "]"}], ">", "1"}], 
                  ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"xj", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "j", ",", "1"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"yj", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "j", ",", "2"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"zj", "=", 
                    RowBox[{"Compile`GetElement", "[", 
                    RowBox[{"X", ",", "j", ",", "3"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"r2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"xi", "-", "xj"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"xi", "-", "xj"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"yi", "-", "yj"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"yi", "-", "yj"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"zi", "-", "zj"}], ")"}], 
                    RowBox[{"(", 
                    RowBox[{"zi", "-", "zj"}], ")"}]}]}]}], ";", 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", 
                   RowBox[{"counter", "+=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{"r2", "<=", "threshold"}], "]"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], "->", "r2"}], "]"}], 
                  ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"++", "j"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"++", "i"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Boole", "[", 
           RowBox[{"counter", "<=", "0"}], "]"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"RuntimeAttributes", "->", 
        RowBox[{"{", "Listable", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Parallelization", "->", "True"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellLabel->
  "In[229]:=",ExpressionUUID->"b49f4e68-7537-4f72-9131-3528908d0d83"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", "6000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"curves", "=", 
    RowBox[{
     RowBox[{"ActionAngleSample", "[", 
      RowBox[{"n", ",", " ", "m"}], "]"}], "[", "\"\<ClosedPolygons\>\"", 
     "]"}]}], ";"}], "//", "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"bools", "=", 
    RowBox[{"cf", "[", "curves", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"goodcurves", "=", 
   RowBox[{"Pick", "[", 
    RowBox[{"curves", ",", "bools", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "goodcurves", "]"}]}], "Input",
 CellLabel->
  "In[338]:=",ExpressionUUID->"304669f8-2c46-46f1-ba62-452409a24891"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.931656`", ",", "Null"}], "}"}]], "Output",
 CellLabel->
  "Out[340]=",ExpressionUUID->"469bbd25-a2c8-4a01-94c8-e1b70d9b7996"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.143522`", ",", "Null"}], "}"}]], "Output",
 CellLabel->
  "Out[341]=",ExpressionUUID->"d1a4499d-2cd4-449a-bd94-f3134ac6143e"],

Cell[BoxData["442"], "Output",
 CellLabel->"Out[343]=",ExpressionUUID->"17bc083d-68ae-4454-935d-50148ccc8697"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomClosedPolygons", "[", 
    RowBox[{"3", ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1.", ",", "n"}], "]"}], ",", "m"}], "]"}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->
  "In[344]:=",ExpressionUUID->"e1cd7d4e-a0bd-4367-bdbe-25d2f07fe5ab"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.154792`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[344]=",ExpressionUUID->"dd79b6a9-7c88-4db9-907c-0599ed62cb3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1000000.", " ", "/", "450"}], " ", "/", " ", "60."}]], "Input",
 CellLabel->
  "In[304]:=",ExpressionUUID->"fa8e4e07-b72f-4e68-bbf4-f11426a5a304"],

Cell[BoxData["37.03703703703704`"], "Output",
 CellLabel->"Out[304]=",ExpressionUUID->"a880295e-763c-4e17-8cdc-2ce4f6d65c7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DistanceMatrix", "[", 
   RowBox[{"goodcurves", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->
  "In[266]:=",ExpressionUUID->"9017cf23-f611-4a86-9cf4-9fd053247c15"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "1.`", "1.707099751288929`", "2.288305751316529`", 
      "3.1547892581925314`", "3.8800458839479544`", "4.866150334911934`", 
      "5.154347982542741`", "4.993700059789934`", "4.458452265452316`", 
      "4.378974678708384`", "4.799890182160267`", "3.9234429699806146`", 
      "4.011777993625993`", "3.3969021366347514`", "3.193881159006835`", 
      "2.2762304621661067`", "1.4621820034921464`", "1.0804654813304018`", 
      "1.`"},
     {"1.`", "0.`", "0.9999999999999999`", "1.304284748835199`", 
      "2.1986573198783197`", "2.9206109594666083`", "3.9032188837276363`", 
      "4.235778719684742`", "4.126068719908139`", "3.7100938812592674`", 
      "3.7296917867694566`", "4.298171041223287`", "3.442422960874748`", 
      "3.618330277314921`", "3.1703986611696915`", "3.112633821328236`", 
      "2.2849582698116016`", "1.2938377567834378`", "1.4643283347802745`", 
      "1.678260201015947`"},
     {"1.707099751288929`", "0.9999999999999999`", "0.`", "1.`", 
      "1.781286972525828`", "2.716741402386772`", "3.6893561063324616`", 
      "3.8795756272112527`", "3.5787905874859214`", "3.1664468935601375`", 
      "3.0000202310574413`", "3.503689523243996`", "2.5907351294335017`", 
      "2.965878991517929`", "2.7544510366709476`", "2.5709804085701715`", 
      "2.003531491106707`", "1.12756848729684`", "1.8943518342877685`", 
      "1.8992293045004025`"},
     {"2.288305751316529`", "1.304284748835199`", "1.`", "0.`", 
      "1.0000000000000007`", "1.8131019958355608`", "2.772175408768333`", 
      "3.1145430974135864`", "3.018717420746347`", "2.8260808542699976`", 
      "2.947888052135152`", "3.6839576446362585`", "2.91639529821411`", 
      "3.251060388879655`", "3.135150503850338`", "3.222885221367878`", 
      "2.6828636549976084`", "1.8506698131567572`", "2.4728347734568548`", 
      "2.7474031749868466`"},
     {"3.1547892581925314`", "2.1986573198783197`", "1.781286972525828`", 
      "1.0000000000000007`", "0.`", "1.0000000000000013`", 
      "1.9339278311714634`", "2.133520738969736`", "2.0393650007142083`", 
      "1.9849720654249525`", "2.3134762630469115`", "3.2023518379655034`", 
      "2.6516444729855047`", "2.9216304284019037`", "3.001985924059779`", 
      "3.30826973098059`", "2.966848875359434`", "2.3890343626315427`", 
      "3.081108277429162`", "3.502238905757419`"},
     {"3.8800458839479544`", "2.9206109594666083`", "2.716741402386772`", 
      "1.8131019958355608`", "1.0000000000000013`", "0.`", 
      "1.0000000000000013`", "1.4554308415444228`", "1.836342847905335`", 
      "2.1077577088288644`", "2.778646963824539`", "3.761226003401139`", 
      "3.4159508682384625`", "3.548960258182912`", "3.6373294028509706`", 
      "4.122219025832389`", "3.7730627059823982`", "3.237508042656425`", 
      "3.782161112165898`", "4.339209251123949`"},
     {"4.866150334911934`", "3.9032188837276363`", "3.6893561063324616`", 
      "2.772175408768333`", "1.9339278311714634`", "1.0000000000000013`", 
      "0.`", "0.999999999999998`", "1.823320945166761`", 
      "2.4657672716087977`", "3.262622776864753`", "4.25095005793945`", 
      "4.084724420041515`", "4.204685357191985`", "4.408551979239522`", 
      "4.961406451668949`", "4.698818558514612`", "4.223058060073106`", 
      "4.761913152535223`", "5.3386181315982055`"},
     {"5.154347982542741`", "4.235778719684742`", "3.8795756272112527`", 
      "3.1145430974135864`", "2.133520738969736`", "1.4554308415444228`", 
      "0.999999999999998`", "0.`", "0.999999999999999`", "1.755439735222366`",
       "2.6251100908192577`", "3.5795517653298705`", "3.624634912004975`", 
      "3.645483664497305`", "3.9806236239994006`", "4.611522551758542`", 
      "4.521989719773063`", "4.251856230205183`", "4.8645318194049905`", 
      "5.460608245266376`"},
     {"4.993700059789934`", "4.126068719908139`", "3.5787905874859214`", 
      "3.018717420746347`", "2.0393650007142083`", "1.836342847905335`", 
      "1.823320945166761`", "0.999999999999999`", "0.`", 
      "0.9999999999999998`", "1.710414557473231`", "2.6207727429433865`", 
      "2.7589516202005453`", "2.8294403273776862`", "3.344341233986516`", 
      "3.909334509170236`", "4.002816333462164`", "3.882225582621377`", 
      "4.620145620814112`", "5.124556444012653`"},
     {"4.458452265452316`", "3.7100938812592674`", "3.1664468935601375`", 
      "2.8260808542699976`", "1.9849720654249525`", "2.1077577088288644`", 
      "2.4657672716087977`", "1.755439735222366`", "0.9999999999999998`", 
      "0.`", "1.0000000000000004`", "1.941894693486434`", 
      "2.0842082502548305`", "1.916909706504076`", "2.3745079484003115`", 
      "3.021192784725012`", "3.156579186382374`", "3.208811602754868`", 
      "3.922618353009252`", "4.456980187311954`"},
     {"4.378974678708384`", "3.7296917867694566`", "3.0000202310574413`", 
      "2.947888052135152`", "2.3134762630469115`", "2.778646963824539`", 
      "3.262622776864753`", "2.6251100908192577`", "1.710414557473231`", 
      "1.0000000000000004`", "0.`", "1.0000000000000007`", 
      "1.1685787747085967`", "1.2092712932754148`", "1.9912097782585747`", 
      "2.3888842774335366`", "2.786686635586092`", "2.9968896760141193`", 
      "3.8362390854325197`", "4.18335666711882`"},
     {"4.799890182160267`", "4.298171041223287`", "3.503689523243996`", 
      "3.6839576446362585`", "3.2023518379655034`", "3.761226003401139`", 
      "4.25095005793945`", "3.5795517653298705`", "2.6207727429433865`", 
      "1.941894693486434`", "1.0000000000000007`", "0.`", 
      "0.9999999999999999`", "1.0338538564866788`", "2.0337268718548613`", 
      "2.1846794725778826`", "2.904409363989611`", "3.3554538174177955`", 
      "4.195981991325683`", "4.402611864183331`"},
     {"3.9234429699806146`", "3.442422960874748`", "2.5907351294335017`", 
      "2.91639529821411`", "2.6516444729855047`", "3.4159508682384625`", 
      "4.084724420041515`", "3.624634912004975`", "2.7589516202005453`", 
      "2.0842082502548305`", "1.1685787747085967`", "0.9999999999999999`", 
      "0.`", "1.0000000000000004`", "1.7520682562604246`", 
      "1.6106963381009423`", "2.2088805790328925`", "2.5191695921722665`", 
      "3.4361883305180885`", "3.5273561562000193`"},
     {"4.011777993625993`", "3.618330277314921`", "2.965878991517929`", 
      "3.251060388879655`", "2.9216304284019037`", "3.548960258182912`", 
      "4.204685357191985`", "3.645483664497305`", "2.8294403273776862`", 
      "1.916909706504076`", "1.2092712932754148`", "1.0338538564866788`", 
      "1.0000000000000004`", "0.`", "0.9999999999999986`", 
      "1.345984672588719`", "1.9735421473548287`", "2.550590455153321`", 
      "3.2853242465503443`", "3.5842279481349473`"},
     {"3.3969021366347514`", "3.1703986611696915`", "2.7544510366709476`", 
      "3.135150503850338`", "3.001985924059779`", "3.6373294028509706`", 
      "4.408551979239522`", "3.9806236239994006`", "3.344341233986516`", 
      "2.3745079484003115`", "1.9912097782585747`", "2.0337268718548613`", 
      "1.7520682562604246`", "0.9999999999999986`", "0.`", 
      "1.0000000000000009`", "1.2562807527581525`", "2.0059433219345078`", 
      "2.5133960689976087`", "2.9427904295341705`"},
     {"3.193881159006835`", "3.112633821328236`", "2.5709804085701715`", 
      "3.222885221367878`", "3.30826973098059`", "4.122219025832389`", 
      "4.961406451668949`", "4.611522551758542`", "3.909334509170236`", 
      "3.021192784725012`", "2.3888842774335366`", "2.1846794725778826`", 
      "1.6106963381009423`", "1.345984672588719`", "1.0000000000000009`", 
      "0.`", "1.0000000000000009`", "1.8430791066233478`", 
      "2.4539265328316358`", "2.524403953639817`"},
     {"2.2762304621661067`", "2.2849582698116016`", "2.003531491106707`", 
      "2.6828636549976084`", "2.966848875359434`", "3.7730627059823982`", 
      "4.698818558514612`", "4.521989719773063`", "4.002816333462164`", 
      "3.156579186382374`", "2.786686635586092`", "2.904409363989611`", 
      "2.2088805790328925`", "1.9735421473548287`", "1.2562807527581525`", 
      "1.0000000000000009`", "0.`", "1.`", "1.458009066406456`", 
      "1.696410739389245`"},
     {"1.4621820034921464`", "1.2938377567834378`", "1.12756848729684`", 
      "1.8506698131567572`", "2.3890343626315427`", "3.237508042656425`", 
      "4.223058060073106`", "4.251856230205183`", "3.882225582621377`", 
      "3.208811602754868`", "2.9968896760141193`", "3.3554538174177955`", 
      "2.5191695921722665`", "2.550590455153321`", "2.0059433219345078`", 
      "1.8430791066233478`", "1.`", "0.`", "0.9999999999999998`", 
      "1.251549431085882`"},
     {"1.0804654813304018`", "1.4643283347802745`", "1.8943518342877685`", 
      "2.4728347734568548`", "3.081108277429162`", "3.782161112165898`", 
      "4.761913152535223`", "4.8645318194049905`", "4.620145620814112`", 
      "3.922618353009252`", "3.8362390854325197`", "4.195981991325683`", 
      "3.4361883305180885`", "3.2853242465503443`", "2.5133960689976087`", 
      "2.4539265328316358`", "1.458009066406456`", "0.9999999999999998`", 
      "0.`", "1.`"},
     {"1.`", "1.678260201015947`", "1.8992293045004025`", 
      "2.7474031749868466`", "3.502238905757419`", "4.339209251123949`", 
      "5.3386181315982055`", "5.460608245266376`", "5.124556444012653`", 
      "4.456980187311954`", "4.18335666711882`", "4.402611864183331`", 
      "3.5273561562000193`", "3.5842279481349473`", "2.9427904295341705`", 
      "2.524403953639817`", "1.696410739389245`", "1.251549431085882`", "1.`",
       "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[266]//MatrixForm=",ExpressionUUID->"160e14ed-45d4-477f-b44c-\
1bc02ef1f9eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Min", "[", 
  RowBox[{
   RowBox[{"DistanceMatrix", "[", 
    RowBox[{"goodcurves", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], "+", 
   RowBox[{"IdentityMatrix", "[", "n", "]"}], "-", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellLabel->
  "In[184]:=",ExpressionUUID->"87282759-95e5-40c1-a8e0-d69868c9d78d"],

Cell[BoxData[
 RowBox[{"-", "0.5994079285453127`"}]], "Output",
 CellLabel->"Out[184]=",ExpressionUUID->"f8459930-2934-433d-9882-569d7285cec2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1000000", "/", "605."}], "/", "60"}]], "Input",
 CellLabel->
  "In[174]:=",ExpressionUUID->"553e77c5-78af-4178-8815-24c15add2510"],

Cell[BoxData["27.548209366391184`"], "Output",
 CellLabel->"Out[174]=",ExpressionUUID->"64547a69-1445-4ef1-a6dd-13819f96166a"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"578cdab1-b02d-4afa-884a-cae2fa55edc5"],

Cell[CellGroupData[{

Cell[BoxData["\[IndentingNewLine]"], \
"Input",ExpressionUUID->"a121c6e8-29cd-48ab-bcf7-edaca8042186"],

Cell[BoxData["590"], "Output",
 CellLabel->
  "Out[21]=",ExpressionUUID->"642db3ff-36e2-4461-ab14-2506c3cfdf00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pick", "[", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", "1"}], "]"}]], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"221b09bd-3781-4089-be50-1cfe8718d2d5"],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output",
 CellLabel->"Out[110]=",ExpressionUUID->"3b2ac071-3f95-4b61-84fe-b2779efb9fac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bools", "=", 
    RowBox[{"cf", "[", 
     RowBox[{"curves", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"f972014c-490b-484f-8b9f-27f905f4ae5b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.005433`", ",", "Null"}], "}"}]], "Output",
 CellLabel->"Out[129]=",ExpressionUUID->"da380a43-b3bf-4904-a570-086ff58d866a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FirstPosition", "[", 
  RowBox[{"bools", ",", "1"}], "]"}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"9b027fca-e501-41eb-bc60-58a76a6114aa"],

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Output",
 CellLabel->"Out[117]=",ExpressionUUID->"74cc634c-fc14-4960-96b2-a0d93ce02d1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bools", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"f92954f6-f387-46ca-a038-8d0b651dce6f"],

Cell[BoxData["1"], "Output",
 CellLabel->"Out[118]=",ExpressionUUID->"dc351302-4106-4dd5-9eef-9cfa6438b4a6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"goodcurves", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "==", 
  RowBox[{"curves", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[124]:=",ExpressionUUID->"a9bfa92b-7ff4-4238-be80-2926b589ae04"],

Cell[BoxData["True"], "Output",
 CellLabel->"Out[124]=",ExpressionUUID->"7d54e91d-f9ac-49b3-8075-63559a8f0e6c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Pick"}]], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"59f1342d-6b1c-4e14-a182-ed97d24ac7b0"],

Cell[BoxData[
 InterpretationBox[
  StyleBox[
   FrameBox[
    DynamicModuleBox[{System`InformationDump`open$$ = False, 
     System`InformationDump`mouseOver$$ = False}, 
     PaneSelectorBox[{True->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False,
             BaseStyle -> None],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"]], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"]]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Pick",
              ButtonNote->"paclet:ref/Pick"],
             "\"paclet:ref/Pick\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Pick\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"sel\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) picks out those elements of \
\\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) for which the corresponding \
element of \\!\\(\\*StyleBox[\\\"sel\\\", \\\"TI\\\"]\\) is True. \
\\n\\!\\(\\*RowBox[{\\\"Pick\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"sel\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"patt\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) picks out those elements \
of \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) for which the corresponding \
element of \\!\\(\\*StyleBox[\\\"sel\\\", \\\"TI\\\"]\\) matches \
\\!\\(\\*StyleBox[\\\"patt\\\", \\\"TI\\\"]\\). \"\>", "InformationUsageText",
             
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          PaneBox[GridBox[{
             {
              
              DynamicModuleBox[{System`InformationDump`open$$ = {
               False, False, False, False, False, False}}, 
               StyleBox[GridBox[{
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Documentation\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Documentation\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Documentation", "Tooltip"]& ], 
                   TemplateBox[{
                    
                    TemplateBox[{
                    "\"Local \[RightGuillemet]\"", "paclet:ref/Pick", 
                    "paclet:ref/Pick", "Link", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"], "\"  \"", 
                    StyleBox[
                    "\"|\"", "InformationRowLabel", StripOnInput -> False], 
                    "\"  \"", 
                    TemplateBox[{"\"Web \[RightGuillemet]\"", {
                    URL[
                    "http://reference.wolfram.com/language/ref/Pick.html"], 
                    None}, "http://reference.wolfram.com/language/ref/Pick.\
html", "Hyperlink", {
                    RGBColor[0.9686274509803922, 0.4666666666666667, 0.]}, 
                    BaseStyle -> {
                    RGBColor[0.0784313725490196, 0.1568627450980392, 0.6]}}, 
                    "HyperlinkTemplate"]},
                    "RowDefault"]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Attributes\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"Attributes\"",
                    TooltipStyle->"TextStyling"],
                    Annotation[#, "Attributes", "Tooltip"]& ], 
                   RowBox[{"{", "Protected", "}"}]},
                  {
                   TagBox[
                    TooltipBox[
                    StyleBox["\<\" Full Name\"\>", "InformationRowLabel",
                    StripOnInput->False],
                    "\"FullName\"",
                    TooltipStyle->"TextStyling"],
                    
                    Annotation[#, "FullName", 
                    "Tooltip"]& ], "\<\"System`Pick\"\>"}
                 },
                 AutoDelete->False,
                 GridBoxAlignment->{"Columns" -> {Right, Left}},
                 GridBoxDividers->None,
                 GridBoxItemSize->{"Columns" -> {Automatic, Automatic}},
                 GridBoxSpacings->{"Columns" -> {
                    Offset[0.27999999999999997`], {
                    Offset[0.5599999999999999]}, 
                    Offset[0.27999999999999997`]}, "Rows" -> {
                    Offset[0.2], {
                    Offset[0.8]}, 
                    Offset[0.2]}}], "DialogStyle",
                StripOnInput->False],
               DynamicModuleValues:>{}]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.5599999999999999]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[3.6]}, 
                Offset[0.2]}}],
           FrameMargins->{{6, 6}, {6, 3}}], ""},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpener"]], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "UpPointerOpenerHot"]]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, False],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"], False->
      TagBox[GridBox[{
         {
          ItemBox[
           PaneBox[
            StyleBox["\<\" Symbol\"\>", "InformationTitleText",
             StripOnInput->False],
            FrameMargins->{{4, 0}, {-1, 1}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], 
          ItemBox[
           PaneBox[
            TooltipBox[
             ButtonBox[
              PaneSelectorBox[{False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIcon"],
                ImageSizeCache->{20., {6., 14.}}], True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "InformationHelpIconHot"],
                ImageSizeCache->{20., {6., 14.}}]}, Dynamic[
                CurrentValue["MouseOver"]]],
              Appearance->None,
              BaseStyle->"Link",
              ButtonData->"paclet:ref/Pick",
              ButtonNote->"paclet:ref/Pick"],
             "\"paclet:ref/Pick\""],
            FrameMargins->{{0, 4}, {0, 2}}],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           PaneBox[
            
            StyleBox["\<\"\\!\\(\\*RowBox[{\\\"Pick\\\", \\\"[\\\", \
RowBox[{StyleBox[\\\"list\\\", \\\"TI\\\"], \\\",\\\", StyleBox[\\\"sel\\\", \
\\\"TI\\\"]}], \\\"]\\\"}]\\) picks out those elements of \
\\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) for which the corresponding \
element of \\!\\(\\*StyleBox[\\\"sel\\\", \\\"TI\\\"]\\) is True. \
\\n\\!\\(\\*RowBox[{\\\"Pick\\\", \\\"[\\\", RowBox[{StyleBox[\\\"list\\\", \
\\\"TI\\\"], \\\",\\\", StyleBox[\\\"sel\\\", \\\"TI\\\"], \\\",\\\", \
StyleBox[\\\"patt\\\", \\\"TI\\\"]}], \\\"]\\\"}]\\) picks out those elements \
of \\!\\(\\*StyleBox[\\\"list\\\", \\\"TI\\\"]\\) for which the corresponding \
element of \\!\\(\\*StyleBox[\\\"sel\\\", \\\"TI\\\"]\\) matches \
\\!\\(\\*StyleBox[\\\"patt\\\", \\\"TI\\\"]\\). \"\>", "InformationUsageText",
             
             StripOnInput->False,
             LineSpacing->{1.5, 1.5, 3.}],
            FrameMargins->{{10, 10}, {8, 10}}],
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False], 
          ItemBox["\<\"\"\>",
           BaseStyle->"InformationUsageSubtitleBackground",
           StripOnInput->False]},
         {
          ItemBox[
           TagBox[
            ButtonBox[
             PaneSelectorBox[{False->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{15., {2., 13.}}], True->
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpenerHot"],
               ImageSizeCache->{15., {2., 13.}}]}, Dynamic[
              System`InformationDump`mouseOver$$]],
             Alignment->Left,
             Appearance->{"Default" -> None},
             
             ButtonFunction:>FEPrivate`Set[
              System`InformationDump`open$$, True],
             Evaluator->Automatic,
             FrameMargins->{{9, 0}, {0, 0}},
             ImageMargins->0,
             ImageSize->Full,
             Method->"Preemptive"],
            
            EventHandlerTag[{
             "MouseEntered" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, True], 
              "MouseExited" :> 
              FEPrivate`Set[System`InformationDump`mouseOver$$, False], 
              Method -> "Preemptive", PassEventsDown -> Automatic, 
              PassEventsUp -> True}]],
           BaseStyle->"InformationTitleBackground",
           StripOnInput->False], "\[SpanFromLeft]"}
        },
        AutoDelete->False,
        FrameStyle->Directive[
          GrayLevel[0.8], 
          Thickness[Tiny]],
        GridBoxAlignment->{"Columns" -> {Left, Right}, "Rows" -> {{Center}}},
        GridBoxDividers->{
         "Columns" -> {{None}}, "Rows" -> {False, {True}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}, Dynamic[System`InformationDump`open$$],
      BaselinePosition->Baseline,
      FrameMargins->0,
      ImageSize->Automatic],
     DynamicModuleValues:>{}],
    BaseStyle->"InformationGridFrame",
    StripOnInput->False], "InformationGridPlain",
   StripOnInput->False],
  InformationData[<|
   "ObjectType" -> "Symbol", "Usage" -> 
    "\!\(\*RowBox[{\"Pick\", \"[\", RowBox[{StyleBox[\"list\", \"TI\"], \
\",\", StyleBox[\"sel\", \"TI\"]}], \"]\"}]\) picks out those elements of \
\!\(\*StyleBox[\"list\", \"TI\"]\) for which the corresponding element of \
\!\(\*StyleBox[\"sel\", \"TI\"]\) is True. \n\!\(\*RowBox[{\"Pick\", \"[\", \
RowBox[{StyleBox[\"list\", \"TI\"], \",\", StyleBox[\"sel\", \"TI\"], \",\", \
StyleBox[\"patt\", \"TI\"]}], \"]\"}]\) picks out those elements of \
\!\(\*StyleBox[\"list\", \"TI\"]\) for which the corresponding element of \
\!\(\*StyleBox[\"sel\", \"TI\"]\) matches \!\(\*StyleBox[\"patt\", \"TI\"]\). \
", "Documentation" -> <|
     "Local" -> "paclet:ref/Pick", "Web" -> 
      "http://reference.wolfram.com/language/ref/Pick.html"|>, "OwnValues" -> 
    None, "UpValues" -> None, "DownValues" -> None, "SubValues" -> None, 
    "DefaultValues" -> None, "NValues" -> None, "FormatValues" -> None, 
    "Options" -> None, "Attributes" -> {Protected}, "FullName" -> 
    "System`Pick"|>, False]]], "Output",
 CellLabel->"Out[109]=",ExpressionUUID->"759b249e-0061-49e6-bd23-4f8b7a99ed2a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pick", "[", 
  RowBox[{
   RowBox[{"curves", "[", 
    RowBox[{"[", 
     RowBox[{"{", "1", "}"}], "]"}], "]"}], ",", 
   RowBox[{"bools", "[", 
    RowBox[{"[", 
     RowBox[{"{", "1", "}"}], "]"}], "]"}], ",", "1"}], "]"}]], "Input",
 CellLabel->"In[99]:=",ExpressionUUID->"93f397f7-fd63-4949-9feb-31853571832c"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellLabel->
  "Out[99]=",ExpressionUUID->"8794bddc-b207-4b67-aa36-6c188c9a2da1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"goodcurves", "=."}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"68e8e925-9e12-4ad3-a338-0f23694f2118"],

Cell[CellGroupData[{

Cell[BoxData["bools"], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"cab774c8-3a50-41c9-86ea-9c663f8b632d"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[44]=",ExpressionUUID->"01497931-8576-4360-a647-6fa34f8c0d40"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cf", "[", 
  RowBox[{"curves", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellLabel->"In[97]:=",ExpressionUUID->"afe7fbeb-72dc-448a-941c-3227d5ad3691"],

Cell[BoxData["0"], "Output",
 CellLabel->
  "Out[97]=",ExpressionUUID->"acb53726-264e-434b-91d8-937fd86f2210"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"DistanceMatrix", "[", 
   RowBox[{"curves", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"280b5a7e-9e50-4234-b42b-5eda5f3b3b17"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "1.`", "1.8654171966876445`", "2.4365983224970513`", 
      "2.0884128625820946`", "1.8655553806820662`", "2.7535945988043093`", 
      "3.1967026836728625`", "3.261912698564156`", "3.1406729934987125`", 
      "3.9171932561192255`", "4.809620053781513`", "4.103731012457694`", 
      "3.5413652190568343`", "3.0296446278897835`", "3.298575948058595`", 
      "2.5491480948024456`", "1.8097341186254687`", "1.201321515892745`", 
      "1.`"},
     {"1.`", "0.`", "1.`", "1.8078774530604975`", "1.8905572775132475`", 
      "1.8111460897198535`", "2.4199256789675947`", "3.036472541128845`", 
      "3.2836340702717464`", "3.437022674483948`", "4.316370240167513`", 
      "5.237422324084387`", "4.6692566588978055`", "4.007639351635645`", 
      "3.664767245921659`", "3.711613767936025`", "2.796626039254676`", 
      "2.225287242506733`", "2.0085017731157015`", "1.7950123628230503`"},
     {"1.8654171966876445`", "1.`", "0.`", "0.9999999999999996`", 
      "1.562817447509555`", "1.5819648385574565`", "1.7605866193681183`", 
      "2.502703399424903`", "2.8769308600742773`", "3.2947330031666118`", 
      "4.21463620671429`", "5.129666318543262`", "4.737328122339292`", 
      "4.027332721588878`", "3.919115441035292`", "3.7899813842658885`", 
      "2.801057370492181`", "2.559952928529776`", "2.666500898196965`", 
      "2.3569324822906816`"},
     {"2.4365983224970513`", "1.8078774530604975`", "0.9999999999999996`", 
      "0.`", "0.9999999999999996`", "1.4276847077820207`", 
      "1.1331568594983352`", "1.6699743216711396`", "2.289651298094265`", 
      "2.9464942867025514`", "3.7743059177659157`", "4.7031719831254994`", 
      "4.467154664375529`", "3.8606341802123043`", "3.979516398992035`", 
      "3.8771884794760343`", "2.9422210357833745`", "2.985291749263962`", 
      "3.1369366363458346`", "2.5844401837350257`"},
     {"2.0884128625820946`", "1.8905572775132475`", "1.562817447509555`", 
      "0.9999999999999996`", "0.`", "1.0000000000000002`", 
      "1.167964919529292`", "1.246120843731409`", "1.8039534927113243`", 
      "2.297277425014854`", "3.024265919846295`", "4.004466814297778`", 
      "3.6930771950360426`", "3.226854643963846`", "3.332076580489607`", 
      "3.444994187123751`", "2.6268263258805575`", "2.6698232525346137`", 
      "2.654982555048265`", "1.893510305860871`"},
     {"1.8655553806820662`", "1.8111460897198535`", "1.5819648385574565`", 
      "1.4276847077820207`", "1.0000000000000002`", "0.`", 
      "1.0000000000000009`", "1.5315258235038807`", "1.4874264371784025`", 
      "1.7212552426460659`", "2.6419449472684677`", "3.5556395493349107`", 
      "3.1699188709799255`", "2.5032666509562307`", "2.551943012881422`", 
      "2.5155220064114974`", "1.6402936737350067`", "1.7759458447433625`", 
      "2.035113019576766`", "1.5803647698998133`"},
     {"2.7535945988043093`", "2.4199256789675947`", "1.7605866193681183`", 
      "1.1331568594983352`", "1.167964919529292`", "1.0000000000000009`", 
      "0.`", "0.9999999999999993`", "1.2571058180726693`", 
      "2.0043108115072386`", "2.84972492778295`", "3.706855944358555`", 
      "3.585834887189614`", "2.9451200501224166`", "3.268160538052835`", 
      "3.055326468233407`", "2.2233767859070395`", "2.6227260081032417`", 
      "3.021674706254516`", "2.551523655971042`"},
     {"3.1967026836728625`", "3.036472541128845`", "2.502703399424903`", 
      "1.6699743216711396`", "1.246120843731409`", "1.5315258235038807`", 
      "0.9999999999999993`", "0.`", "1.0000000000000007`", 
      "1.8846148668706115`", "2.4382821025378907`", "3.323675836612582`", 
      "3.323741668139546`", "2.945700197570649`", "3.4187523729931306`", 
      "3.405829407101685`", "2.761643425565952`", "3.214079643918869`", 
      "3.4501755115548827`", "2.7660989350108243`"},
     {"3.261912698564156`", "3.2836340702717464`", "2.8769308600742773`", 
      "2.289651298094265`", "1.8039534927113243`", "1.4874264371784025`", 
      "1.2571058180726693`", "1.0000000000000007`", "0.`", 
      "1.0000000000000002`", "1.6551467471297967`", "2.480712354726426`", 
      "2.496726654547767`", "2.0273558085704275`", "2.639129800740149`", 
      "2.5383940757302805`", "2.0698707111207475`", "2.7452642100389215`", 
      "3.154724737840579`", "2.6676614965529244`"},
     {"3.1406729934987125`", "3.437022674483948`", "3.2947330031666118`", 
      "2.9464942867025514`", "2.297277425014854`", "1.7212552426460659`", 
      "2.0043108115072386`", "1.8846148668706115`", "1.0000000000000002`", 
      "0.`", "1.0000000000000004`", "1.838707219063995`", 
      "1.5869919139312558`", "1.0632782347152436`", "1.7019717705032147`", 
      "1.7686575068266395`", "1.6097085381684892`", "2.304527809302086`", 
      "2.691371597142726`", "2.3628491994628336`"},
     {"3.9171932561192255`", "4.316370240167513`", "4.21463620671429`", 
      "3.7743059177659157`", "3.024265919846295`", "2.6419449472684677`", 
      "2.84972492778295`", "2.4382821025378907`", "1.6551467471297967`", 
      "1.0000000000000004`", "0.`", "1.0000000000000004`", 
      "0.9961603561257827`", "1.2250034973469575`", "2.0283931145755982`", 
      "2.31664525629926`", "2.4899609532666913`", "3.148607648213979`", 
      "3.4054767908813512`", "3.019660138779609`"},
     {"4.809620053781513`", "5.237422324084387`", "5.129666318543262`", 
      "4.7031719831254994`", "4.004466814297778`", "3.5556395493349107`", 
      "3.706855944358555`", "3.323675836612582`", "2.480712354726426`", 
      "1.838707219063995`", "1.0000000000000004`", "0.`", 
      "0.9999999999999979`", "1.5508086745747829`", "2.418079044234236`", 
      "2.608502366011409`", "3.0775509391210414`", "3.8155567086788293`", 
      "4.1525809872479025`", "3.904283372719506`"},
     {"4.103731012457694`", "4.6692566588978055`", "4.737328122339292`", 
      "4.467154664375529`", "3.6930771950360426`", "3.1699188709799255`", 
      "3.585834887189614`", "3.323741668139546`", "2.496726654547767`", 
      "1.5869919139312558`", "0.9961603561257827`", "0.9999999999999979`", 
      "0.`", "0.9999999999999997`", "1.567722728498011`", 
      "2.0624958890427654`", "2.5794503297071967`", "3.1300596128984846`", 
      "3.3379831516362737`", "3.1674317051411647`"},
     {"3.5413652190568343`", "4.007639351635645`", "4.027332721588878`", 
      "3.8606341802123043`", "3.226854643963846`", "2.5032666509562307`", 
      "2.9451200501224166`", "2.945700197570649`", "2.0273558085704275`", 
      "1.0632782347152436`", "1.2250034973469575`", "1.5508086745747829`", 
      "0.9999999999999997`", "0.`", "1.000000000000001`", 
      "1.1358589311065288`", "1.6219222695281295`", "2.3035978559994246`", 
      "2.74057117860829`", "2.7260919788830327`"},
     {"3.0296446278897835`", "3.664767245921659`", "3.919115441035292`", 
      "3.979516398992035`", "3.332076580489607`", "2.551943012881422`", 
      "3.268160538052835`", "3.4187523729931306`", "2.639129800740149`", 
      "1.7019717705032147`", "2.0283931145755982`", "2.418079044234236`", 
      "1.567722728498011`", "1.000000000000001`", "0.`", 
      "1.0000000000000004`", "1.500674780479273`", "1.7476353759565122`", 
      "2.018568294397694`", "2.2571356538802627`"},
     {"3.298575948058595`", "3.711613767936025`", "3.7899813842658885`", 
      "3.8771884794760343`", "3.444994187123751`", "2.5155220064114974`", 
      "3.055326468233407`", "3.405829407101685`", "2.5383940757302805`", 
      "1.7686575068266395`", "2.31664525629926`", "2.608502366011409`", 
      "2.0624958890427654`", "1.1358589311065288`", "1.0000000000000004`", 
      "0.`", "1.0000000000000018`", "1.6413070726093084`", 
      "2.355275304071222`", "2.7223173785116215`"},
     {"2.5491480948024456`", "2.796626039254676`", "2.801057370492181`", 
      "2.9422210357833745`", "2.6268263258805575`", "1.6402936737350067`", 
      "2.2233767859070395`", "2.761643425565952`", "2.0698707111207475`", 
      "1.6097085381684892`", "2.4899609532666913`", "3.0775509391210414`", 
      "2.5794503297071967`", "1.6219222695281295`", "1.500674780479273`", 
      "1.0000000000000018`", "0.`", "0.9999999999999997`", 
      "1.8644702780362197`", "2.139303460635442`"},
     {"1.8097341186254687`", "2.225287242506733`", "2.559952928529776`", 
      "2.985291749263962`", "2.6698232525346137`", "1.7759458447433625`", 
      "2.6227260081032417`", "3.214079643918869`", "2.7452642100389215`", 
      "2.304527809302086`", "3.148607648213979`", "3.8155567086788293`", 
      "3.1300596128984846`", "2.3035978559994246`", "1.7476353759565122`", 
      "1.6413070726093084`", "0.9999999999999997`", "0.`", 
      "0.9999999999999998`", "1.6229715666750852`"},
     {"1.201321515892745`", "2.0085017731157015`", "2.666500898196965`", 
      "3.1369366363458346`", "2.654982555048265`", "2.035113019576766`", 
      "3.021674706254516`", "3.4501755115548827`", "3.154724737840579`", 
      "2.691371597142726`", "3.4054767908813512`", "4.1525809872479025`", 
      "3.3379831516362737`", "2.74057117860829`", "2.018568294397694`", 
      "2.355275304071222`", "1.8644702780362197`", "0.9999999999999998`", 
      "0.`", "1.`"},
     {"1.`", "1.7950123628230503`", "2.3569324822906816`", 
      "2.5844401837350257`", "1.893510305860871`", "1.5803647698998133`", 
      "2.551523655971042`", "2.7660989350108243`", "2.6676614965529244`", 
      "2.3628491994628336`", "3.019660138779609`", "3.904283372719506`", 
      "3.1674317051411647`", "2.7260919788830327`", "2.2571356538802627`", 
      "2.7223173785116215`", "2.139303460635442`", "1.6229715666750852`", 
      "1.`", "0.`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellLabel->
  "Out[125]//MatrixForm=",ExpressionUUID->"8f54bc08-f39b-4cd5-bfe0-\
56e47b546c04"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bools", "=", 
    RowBox[{"cf", "[", 
     RowBox[{
      RowBox[{"curves", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"Range", "[", "m", "]"}]}], "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"8ebb3f25-27b5-4cf1-b77a-551157b3da56"],

Cell[BoxData["bools"], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"379cc936-949f-4193-8654-4b6da4b1c390"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistanceMatrix", "[", 
   RowBox[{"goodcurves", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"6060fbca-0516-467c-b0b0-94f7beae5bdb"],

Cell[CellGroupData[{

Cell[BoxData[""], \
"Input",ExpressionUUID->"948c53f6-c7a7-407d-8c9c-930e7651e901"],

Cell[BoxData[
 RowBox[{"-", "6.661338147750939`*^-16"}]], "Output",
 CellLabel->"Out[175]=",ExpressionUUID->"60da5e28-bf6c-43d8-8bd6-1fd77c32bf74"]
}, Open  ]],

Cell[BoxData[""], \
"Input",ExpressionUUID->"db07da2d-b08c-4f2c-98db-709224fecb08"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"0774f598-5310-45d7-a670-edd411f6a0a7"],

Cell[BoxData[
 RowBox[{"Length", "[", "goodcurves", "]"}]], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"037894d7-f26c-448f-a3fc-a9b7343cf2b7"],

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{"bools", ",", "1"}], "]"}]], "Input",
 CellLabel->"In[66]:=",ExpressionUUID->"b2725874-f02d-446f-844d-c830a14e0103"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{"bools", ",", "1"}], "]"}], "/", "m"}], "//", "N"}]], "Input",
 CellLabel->"In[67]:=",ExpressionUUID->"a482d32a-3ba0-44cd-8dcc-85caae96cfa5"],

Cell[BoxData["m"], "Input",
 CellLabel->"In[63]:=",ExpressionUUID->"30cc64f7-b03e-4c0a-84d1-f8dc2b0b8c25"],

Cell[BoxData[
 RowBox[{"Length", "[", "goodcurves", "]"}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"bc529cac-c0f6-416b-aaa8-9c6d35c128dd"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"f96a307e-6177-4d46-b6b5-b93663fe895f"],

Cell[BoxData[
 RowBox[{"Total", "[", "counts", "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"49d8c468-3dd1-498e-a0cd-dd45f8db722a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributeDefinitions", "[", "f", "]"}], ";"}]], "Input",
 CellLabel->"In[81]:=",ExpressionUUID->"53d8518d-60c8-4a30-92cf-e2bd0b41df87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bool", "=", 
    RowBox[{"ParallelMap", "[", 
     RowBox[{"f", ",", 
      RowBox[{"curves", "[", "\"\<ClosedPolygons\>\"", "]"}], ",", 
      RowBox[{"Method", "->", "\"\<CoarsestGrained\>\""}]}], "]"}]}], ";"}], "//",
   "AbsoluteTiming"}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"fd9aed89-2e71-4aa3-869b-a013ef871672"],

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{"bool", ",", "True"}], "]"}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"b8d05689-b7c6-4478-a74d-a68dea2e82c1"],

Cell[BoxData[
 RowBox[{"cNorm", "[", 
  RowBox[{"Differences", "@@", 
   RowBox[{"curves", "[", "\"\<ClosedPolygons\>\"", "]"}]}], "]"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"99900e11-6d6d-4d3c-b389-1d1c07201ed3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"Init", "[", 
    RowBox[{"polygon", ",", 
     RowBox[{"goodcurves", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Closed\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"fe5583f2-2ec5-462b-a069-c5345584c91d"],

Cell[BoxData[""], \
"Input",ExpressionUUID->"c19b33d5-44c0-4dbb-b368-ea1c2957baa7"],

Cell[BoxData[
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{"TubePlot", "[", "M", "]"}], "\[IndentingNewLine]", "]"}]], "Input",
 
 CellLabel->"In[49]:=",ExpressionUUID->"49ca61c4-0eae-434f-83ba-82872a8fdf49"],

Cell[BoxData[
 RowBox[{"EdgeLengths", "[", "M", "]"}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"4db8b202-fbdd-4820-9f34-ed1cda13a828"],

Cell[BoxData[
 RowBox[{
  RowBox[{"curves", "[", "\"\<ClosedPolygons\>\"", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"7f22441a-b45a-416b-a5f5-b0f640ba4880"],

Cell[BoxData[
 RowBox[{"?", "Nearest"}]], "Input",
 CellLabel->"In[40]:=",ExpressionUUID->"dbf81de1-3c14-4017-b7f2-39759741851d"],

Cell[BoxData[
 RowBox[{"bla", "=", 
  RowBox[{"/@", 
   RowBox[{
   "curves", "[", "\"\<ClosedPolygons\>\"", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"24c1c391-15b4-485e-a228-2fd27cadb150"],

Cell[BoxData[
 RowBox[{"bla", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Length", "/@", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{"#", "->", "\"\<Index\>\""}], ",", "#", ",", 
       RowBox[{"{", 
        RowBox[{"\[Infinity]", ",", 
         RowBox[{"1.", "+", "$MachineEpsilon"}]}], "}"}]}], "]"}]}], "&"}], "/@", 
   RowBox[{
   "curves", "[", "\"\<ClosedPolygons\>\"", 
    "]"}]}]}]], \
"Input",ExpressionUUID->"faf6eb21-aae8-42c3-ae20-8d50ef0719bc"],

Cell[BoxData[
 RowBox[{"bla", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "5"}], "]"}], "]"}]], "Input",
 CellLabel->"In[44]:=",ExpressionUUID->"de7c2ae1-f044-49ad-be7e-b6cab45a4b91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EdgeLengths", "[", "M", "]"}], "-", "1"}]], "Input",
 CellLabel->"In[50]:=",ExpressionUUID->"66e66c20-8601-488d-b9db-391b055249c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nearest", "/@", 
    RowBox[{"curves", "[", "\"\<ClosedPolygons\>\"", "]"}]}], ";"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"29314fe7-d3d2-477c-a62c-4f123ddfce1c"],

Cell[BoxData[
 RowBox[{"curves", "//", "Keys"}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"77947607-491e-428b-879e-12d5cbcdf596"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Nearest", "/@", "curves"}], ";"}]], "Input",
 CellLabel->
  "In[18]:=",ExpressionUUID->"3b6d0907-4819-41c8-b5b1-e08c3cda3acd"]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"73625570-1f10-4484-a975-174cf3ce5425"
]

