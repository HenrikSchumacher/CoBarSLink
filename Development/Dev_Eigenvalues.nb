(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44978,       1044]
NotebookOptionsPosition[     38951,        966]
NotebookOutlinePosition[     39388,        983]
CellTagsIndexPosition[     39345,        980]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Exit"], "Input",
 CellChangeTimes->{{3.873864239407578*^9, 3.8738642403220377`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"e900fb1a-6400-48b5-9ddb-415fcad81665"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Get", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
       "\"\<CoBarSLink.m\>\""}], "}"}], "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"CoBarSLink`Private`clearLibraries", "[", "]"}]}], "Input",
 CellChangeTimes->{{3.8802095908904676`*^9, 3.8802096051713343`*^9}, 
   3.880210597814003*^9, {3.906710797686582*^9, 3.906710798578744*^9}, {
   3.906718133938858*^9, 3.9067181395969963`*^9}, {3.906753131039899*^9, 
   3.906753132420219*^9}, {3.906820791878879*^9, 3.906820792551619*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"a14e8661-385b-49e8-846a-93b79486cbef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"LibraryFunctionUnload", "[", "cEigs", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "cEigs", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cEigs", "[", "d_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"cEigs", "[", "d", "]"}], "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lib", ",", " ", "libname", ",", " ", "name", ",", " ", "code", ",", 
        " ", "t"}], "}"}], ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"libname", " ", "=", " ", 
        RowBox[{"name", " ", "=", " ", 
         RowBox[{"\"\<cEigs_\>\"", "<>", 
          RowBox[{"IntegerString", "[", "d", "]"}]}]}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"lib", " ", "=", " ", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"CoBarSLink`Private`$libraryDirectory", ",", " ", 
           RowBox[{
           "libname", "<>", 
            "CCompilerDriver`CCompilerDriverBase`$PlatformDLLExtension"}]}], 
          "}"}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"True", ",", "\n", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Compiling \>\"", "<>", "name", "<>", "\"\<...\>\""}], 
           "]"}], ";", "\n", "\n", "\t\t", 
          RowBox[{"code", " ", "=", " ", 
           RowBox[{"StringJoin", "[", "\n", 
            RowBox[{
            "\"\<\n#define NDEBUG\n\n#define TOOLS_ENABLE_PROFILER\n\n\
#include \\\"WolframLibrary.h\\\"\n#include \\\"MMA.hpp\\\"\n\n#include \
\\\"CoBarS.hpp\\\"\n\nusing namespace Tools;\nusing namespace Tensors;\nusing \
namespace CoBarS;\nusing namespace mma;\n\nusing Real = mreal;\nusing Int  = \
mint;\n\nstatic constexpr Int n = \>\"", "<>", 
             RowBox[{"IntegerString", "[", "d", "]"}], "<>", 
             "\"\<;\n\nEXTERN_C DLLEXPORT int \>\"", "<>", "name", "<>", 
             "\"\<(WolframLibraryData libData, mint Argc, MArgument *Args, \
MArgument Res )\n{\n\t//Profiler::Clear(\\\"\>\"", "<>", "$HomeDirectory", 
             "<>", "\"\<\\\");\n\n\tTiny::SelfAdjointMatrix<n,Real,Int> A;\n\t\
Tiny::Matrix<n,n,Real,Int> Q;\n\tTiny::Vector<n,  Real,Int> v;\n\n\tfor( Int \
i = 0; i < n; ++i )\n\t{\n\t\tfor( Int j = i; j < n; ++j )\n\t\t{\n\t\t\t\
A[i][j] = data<Real>(Args[0])[n*i+j];\n\t\t}\n\t}\n\n\tA.Eigensystem( Q, v, \
get<Real>(Args[3]), get<Int>(Args[4]) );\n\n\tQ.Write( data<Real>(Args[1]) );\
\n\tv.Write( data<Real>(Args[2]) );\n\t\n\n\treturn LIBRARY_NO_ERROR;\n\
}\>\""}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"t", " ", "=", " ", 
           RowBox[{
            RowBox[{"AbsoluteTiming", "[", "\n", "\t\t\t", 
             RowBox[{"lib", " ", "=", " ", 
              RowBox[{"CreateLibrary", "[", "\n", "\t\t\t\t", 
               RowBox[{
               "code", ",", "\n", "\t\t\t\t", "libname", ",", "\n", 
                "\t\t\t\t", 
                RowBox[{"\"\<Language\>\"", "->", "\"\<C++\>\""}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{
                "\"\<TargetDirectory\>\"", "->", " ", 
                 "CoBarSLink`Private`$libraryDirectory"}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "\"\<ShellCommandFunction\>\"", "\[Rule]", "Print"}], ","}],
                  "*)"}], "\n", "\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"\"\<ShellOutputFunction\>\"", "\[Rule]", "Print"}],
                   ","}], "*)"}], "\n", "\t\t\t\t", 
                "CoBarSLink`Private`$compilationOptions"}], "\n", "\t\t\t", 
               "]"}]}], "\n", "\t\t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Compilation done. Time elapsed = \>\"", ",", " ", "t", ",", 
            " ", "\"\< s.\\n\>\""}], "]"}], ";"}]}], "\n", "\t", "]"}], ";", 
       "\[IndentingNewLine]", "\n", "\t", 
       RowBox[{"LibraryFunctionLoad", "[", 
        RowBox[{"lib", ",", "name", ",", "\n", "\t\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Real", ",", "2", ",", "\"\<Constant\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Real", ",", "2", ",", "\"\<Shared\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Real", ",", "1", ",", "\"\<Shared\>\""}], "}"}], ",", 
           "Real", ",", "Integer"}], "}"}], ",", "\n", "\t\t", 
         "\"\<Void\>\""}], "\n", "\t", "]"}]}]}], "\n", "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.9068197670125923`*^9, 3.906819817118454*^9}, {
   3.9068211109812117`*^9, 3.90682118306231*^9}, {3.9068212444305983`*^9, 
   3.906821387457823*^9}, {3.906821607008772*^9, 3.906821682421795*^9}, {
   3.906821727088399*^9, 3.90682173601226*^9}, 3.906821768087974*^9, {
   3.906821800116531*^9, 3.9068218521106586`*^9}, {3.906821949787882*^9, 
   3.9068219798552437`*^9}, {3.906822031184641*^9, 3.906822033612309*^9}, {
   3.9068222749043922`*^9, 3.906822280243369*^9}, {3.90682241556083*^9, 
   3.906822480937152*^9}, {3.9068225356345253`*^9, 3.906822666244584*^9}, {
   3.9068227441292953`*^9, 3.906822744903802*^9}, {3.906822799332069*^9, 
   3.9068228184809427`*^9}, {3.9068229205681963`*^9, 3.906822921327153*^9}, {
   3.906822987199568*^9, 3.906823012684569*^9}, {3.906829669492791*^9, 
   3.9068296696848583`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"8c260fe9-ea94-4689-93c0-e950cc7e7119"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "\[Transpose]"}], ".", "#"}], "&"}], "@", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "10"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"Dimensions", "[", "A", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"Length", "[", "A", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "16"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxiter", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "U"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cEigs", "[", 
   RowBox[{"Length", "[", "A", "]"}], "]"}], "[", 
  RowBox[{"A", ",", "Q", ",", "\[Lambda]", ",", "tol", ",", "maxiter"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9068328099167643`*^9, 3.9068328102670813`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"02cd7682-3580-42d3-ad26-b7e7fd0517b6"],

Cell[BoxData[{
 RowBox[{"Sort", "[", "\[Lambda]", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", "\[Mu]", "]"}]}], "Input",
 CellChangeTimes->{{3.906831581537014*^9, 3.9068315965701942`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a288e2c6-d9ea-47c4-b1d5-fd60e4fbd058"],

Cell[BoxData[{
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"(", 
      RowBox[{"\[Mu]", " ", "U"}], ")"}]}], "-", "A"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Q", ".", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"Q", "\[Transpose]"}]}], ")"}]}], "-", "A"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.906832268825898*^9, 3.906832271528243*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"b9fe3a26-a418-46c5-ae6c-2600da551291"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906831582851817*^9, 
  3.90683159531592*^9}},ExpressionUUID->"29cf32c6-cdea-4a6a-9faf-\
5c27360dae2b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.906831540627844*^9, 
  3.9068315407908163`*^9}},ExpressionUUID->"36b81ab2-0067-4582-ab3c-\
254210b8e980"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.", ",", "11"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"samplecount", "=", "1000000"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<A\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"data1", "=", 
     RowBox[{"CoBarSample", "[", 
      RowBox[{"\"\<Gyradius\>\"", ",", "d", ",", "r", ",", "samplecount", ",", 
       RowBox[{"\"\<QuotientSpace\>\"", "->", "False"}], ",", 
       RowBox[{"\"\<ThreadCount\>\"", "->", "8"}]}], "]"}]}], ";"}], "//", 
   "AbsoluteTiming"}], "//", "First"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", "\"\<B\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data2", "=", 
       RowBox[{"CoBarSample", "[", 
        RowBox[{
        "\"\<Gyradius\>\"", ",", "d", ",", "r", ",", "samplecount", ",", 
         RowBox[{"\"\<QuotientSpace\>\"", "->", "True"}]}], "]"}]}], ";"}], "//",
      "AbsoluteTiming"}], "//", "First"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.9068198473664217`*^9, 3.906819852208757*^9}, {
   3.906819941568572*^9, 3.9068199756426163`*^9}, {3.906820023173788*^9, 
   3.906820038392017*^9}, {3.906820737138287*^9, 3.906820737896207*^9}, {
   3.906825777726884*^9, 3.90682578980604*^9}, {3.9068260475800333`*^9, 
   3.9068260536426897`*^9}, {3.9068286422103367`*^9, 3.9068286429616423`*^9}, 
   3.9068309061473637`*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"47b4291b-5a3a-4d7d-b062-f8ae92b4cb6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"1.", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"samplecount", "=", "1000000"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", "\"\<A\>\"", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data1", "=", 
       RowBox[{"CoBarSample", "[", 
        RowBox[{
        "\"\<Gyradius\>\"", ",", "d", ",", "r", ",", "samplecount", ",", 
         RowBox[{"\"\<QuotientSpace\>\"", "->", "False"}]}], "]"}]}], ";"}], "//",
      "AbsoluteTiming"}], "//", "First"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<B\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"data2", "=", 
     RowBox[{"CoBarSample", "[", 
      RowBox[{"\"\<Gyradius\>\"", ",", "d", ",", "r", ",", "samplecount", ",", 
       RowBox[{"\"\<QuotientSpace\>\"", "->", "True"}]}], "]"}]}], ";"}], "//",
    "AbsoluteTiming"}], "//", "First"}]}], "Input",
 CellChangeTimes->{{3.880209709175191*^9, 3.880209743228222*^9}, {
   3.880210351612916*^9, 3.880210352750519*^9}, {3.880210743164852*^9, 
   3.880210744333995*^9}, {3.8802108351857853`*^9, 3.8802108694490843`*^9}, {
   3.880211051510435*^9, 3.880211053581135*^9}, {3.8802111008117*^9, 
   3.8802111034048967`*^9}, {3.8957083799180517`*^9, 3.89570838678792*^9}, {
   3.895708728834546*^9, 3.8957087343437653`*^9}, {3.895710650051489*^9, 
   3.895710695701086*^9}, 3.897894390870591*^9, {3.897895963118763*^9, 
   3.8978959660085983`*^9}, {3.898009035883202*^9, 3.898009038590455*^9}, {
   3.906718145623558*^9, 3.906718150196611*^9}, {3.906718199848043*^9, 
   3.906718206430297*^9}, {3.906753219688431*^9, 3.906753254573318*^9}, {
   3.906753437798175*^9, 3.90675343789825*^9}, {3.906753477836337*^9, 
   3.906753492274331*^9}, {3.9067554084817677`*^9, 3.9067555477067003`*^9}, {
   3.9068192566021357`*^9, 3.906819261299687*^9}, 3.9068286791469173`*^9, {
   3.906833057960009*^9, 3.906833084068523*^9}, {3.9068331239051447`*^9, 
   3.9068331552909937`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"1496a5fd-43e1-4cbd-b75a-3c2eaa89748c"],

Cell[BoxData[
 RowBox[{"cEigs", "[", "10", "]"}]], "Input",
 CellChangeTimes->{{3.906822890507139*^9, 3.9068228911254177`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"317a3449-cf3d-4651-996c-0235515970c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"LibraryFunctionUnload", "[", "cHessEigs", "]"}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ClearAll", "[", "cHessEigs", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cHessEigs", "[", "d_Integer", "]"}], ":=", 
   RowBox[{
    RowBox[{"cHessEigs", "[", "d", "]"}], "=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "lib", ",", " ", "libname", ",", " ", "name", ",", " ", "code", ",", 
        " ", "t"}], "}"}], ",", "\n", "\n", "\t", 
      RowBox[{
       RowBox[{"libname", " ", "=", " ", 
        RowBox[{"name", " ", "=", " ", 
         RowBox[{"\"\<cHessEigs_\>\"", "<>", 
          RowBox[{"IntegerString", "[", "d", "]"}]}]}]}], ";", "\n", "\n", 
       "\t", 
       RowBox[{"lib", " ", "=", " ", 
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"CoBarSLink`Private`$libraryDirectory", ",", " ", 
           RowBox[{
           "libname", "<>", 
            "CCompilerDriver`CCompilerDriverBase`$PlatformDLLExtension"}]}], 
          "}"}], "]"}]}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"If", "[", 
        RowBox[{"True", ",", "\n", "\n", "\t\t", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Compiling \>\"", "<>", "name", "<>", "\"\<...\>\""}], 
           "]"}], ";", "\n", "\n", "\t\t", 
          RowBox[{"code", " ", "=", " ", 
           RowBox[{"StringJoin", "[", "\n", 
            RowBox[{
            "\"\<\n#define NDEBUG\n\n#define TOOLS_ENABLE_PROFILER\n\n\
#include \\\"WolframLibrary.h\\\"\n#include \\\"MMA.hpp\\\"\n\n#include \
\\\"CoBarS.hpp\\\"\n\nusing namespace Tools;\nusing namespace Tensors;\nusing \
namespace CoBarS;\nusing namespace mma;\n\nusing Real = mreal;\nusing Int  = \
mint;\n\nstatic constexpr Int n = \>\"", "<>", 
             RowBox[{"IntegerString", "[", "d", "]"}], "<>", 
             "\"\<;\n\nEXTERN_C DLLEXPORT int \>\"", "<>", "name", "<>", 
             "\"\<(WolframLibraryData libData, mint Argc, MArgument *Args, \
MArgument Res )\n{\n\t//Profiler::Clear(\\\"\>\"", "<>", "$HomeDirectory", 
             "<>", "\"\<\\\");\n\n\t\
Tiny::SelfAdjointTridiagonalMatrix<n,Real,Int> T;\n\t\
Tiny::Matrix<n,n,Real,Int> Q;\n\tTiny::Vector<n,  Real,Int> eigs;\n\n\tfor( \
Int i = 0; i < n; ++i )\n\t{\n\t\tT.Diag(i) = data<Real>(Args[0])[i];\n\t}\n\n\
\tfor( Int i = 0; i < n-1; ++i )\n\t{\n\t\tT.Upper(i) = \
data<Real>(Args[1])[i];\n\t}\n\n\tT.QRAlgorithm( Q, eigs, get<Real>(Args[2]), \
get<Int>(Args[3]) );\n\n\tMTensor result = make_MTensor<Real>( {n} );\n\n\t\
eigs.Write( data<Real>(result) );\n\n\tget<MTensor>(Res) = result;\n\n\t\
return LIBRARY_NO_ERROR;\n}\>\""}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"t", " ", "=", " ", 
           RowBox[{
            RowBox[{"AbsoluteTiming", "[", "\n", "\t\t\t", 
             RowBox[{"lib", " ", "=", " ", 
              RowBox[{"CreateLibrary", "[", "\n", "\t\t\t\t", 
               RowBox[{
               "code", ",", "\n", "\t\t\t\t", "libname", ",", "\n", 
                "\t\t\t\t", 
                RowBox[{"\"\<Language\>\"", "->", "\"\<C++\>\""}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{
                "\"\<TargetDirectory\>\"", "->", " ", 
                 "CoBarSLink`Private`$libraryDirectory"}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{
                  "\"\<ShellCommandFunction\>\"", "\[Rule]", "Print"}], ","}],
                  "*)"}], "\n", "\t\t\t\t", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"\"\<ShellOutputFunction\>\"", "\[Rule]", "Print"}],
                   ","}], "*)"}], "\n", "\t\t\t\t", 
                "CoBarSLink`Private`$compilationOptions"}], "\n", "\t\t\t", 
               "]"}]}], "\n", "\t\t", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Compilation done. Time elapsed = \>\"", ",", " ", "t", ",", 
            " ", "\"\< s.\\n\>\""}], "]"}], ";"}]}], "\n", "\t", "]"}], ";", 
       "\n", "\t", "\n", "\t", 
       RowBox[{"LibraryFunctionLoad", "[", 
        RowBox[{"lib", ",", "name", ",", "\n", "\t\t", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Real", ",", "1", ",", "\"\<Constant\>\""}], "}"}], ",", 
           "Real", ",", "Integer"}], "}"}], ",", "\n", "\t\t", 
         RowBox[{"{", 
          RowBox[{"Real", ",", "1"}], "}"}]}], "\n", "\t", "]"}]}]}], "\n", 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9068197670125923`*^9, 3.906819817118454*^9}, {
   3.9068211109812117`*^9, 3.90682118306231*^9}, {3.9068212444305983`*^9, 
   3.906821387457823*^9}, {3.906821607008772*^9, 3.906821682421795*^9}, {
   3.906821727088399*^9, 3.90682173601226*^9}, 3.906821768087974*^9, {
   3.906821800116531*^9, 3.9068218521106586`*^9}, {3.906821949787882*^9, 
   3.9068219798552437`*^9}, {3.906822031184641*^9, 3.906822033612309*^9}, {
   3.9068222749043922`*^9, 3.906822280243369*^9}, 3.906822550681077*^9, {
   3.906822651845834*^9, 3.906822676830188*^9}, {3.9068227539816217`*^9, 
   3.906822756105603*^9}, {3.906822823141789*^9, 3.9068228253746643`*^9}, {
   3.906823018334847*^9, 3.9068230210213223`*^9}, {3.906829657491872*^9, 
   3.906829657655361*^9}, 3.906831050247517*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"afba0aeb-6753-4f16-8faa-02863b15957a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"diag", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "4.46580245459024", ",", " ", "0.09940895528250084", ",", " ", 
     "0.02585541955192211", ",", " ", "0.0001279344535252102", ",", " ", 
     "1.522679317474652", ",", " ", "1.300688473844811", ",", " ", 
     "1.374649197314393", ",", " ", "0.8480239871470808", ",", " ", 
     "0.6463186544351915", ",", " ", "0.7164456059056875"}], " ", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"upper", " ", "=", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"5.173643885572209", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "74"}]}]}], ",", " ", "0.0007737845501044303", ",", " ", 
      
      RowBox[{"1.042751245077245", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "13"}]}]}], ",", " ", 
      RowBox[{"5.148565077416751", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "23"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"-", "2.081400098746483"}], " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "19"}]}]}], ",", " ", 
      RowBox[{"1.078212738371189", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "12"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"-", "2.364061142616929"}], " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "21"}]}]}], ",", " ", 
      RowBox[{"5.347351695102168", " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "11"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"-", "9.713329630634092"}], " ", 
       RowBox[{"10", "^", 
        RowBox[{"-", "10"}]}]}]}], " ", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "=", 
    RowBox[{
     RowBox[{"DiagonalMatrix", "[", "diag", "]"}], "+", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"upper", ",", "1"}], "]"}], "+", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"upper", ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"Dimensions", "[", "A", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0.", ",", 
     RowBox[{"Length", "[", "A", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tol", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "16"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxiter", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Mu]", ",", "U"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cEigs", "[", 
    RowBox[{"Length", "[", "A", "]"}], "]"}], "[", 
   RowBox[{"A", ",", "Q", ",", "\[Lambda]", ",", "tol", ",", "maxiter"}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.90682091849549*^9, 3.906820948985962*^9}, {
   3.906822933463873*^9, 3.906822959732868*^9}, {3.906829375377026*^9, 
   3.9068293845342493`*^9}, {3.9068295557906427`*^9, 
   3.9068295652650948`*^9}, {3.9068303475501003`*^9, 3.906830348043992*^9}, {
   3.906830703632228*^9, 3.9068307173759747`*^9}, {3.906831106177662*^9, 
   3.9068311064919024`*^9}, 3.906831156107193*^9, {3.9068323386934958`*^9, 
   3.906832338828301*^9}, 3.9068326357048483`*^9, {3.90683277487164*^9, 
   3.9068327753051033`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"2840e546-db6e-4ab3-9a4a-7d16138034f9"],

Cell[BoxData[{
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"(", 
      RowBox[{"\[Mu]", " ", "U"}], ")"}]}], "-", "A"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Q", ".", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"Q", "\[Transpose]"}]}], ")"}]}], "-", "A"}], "]"}], 
  "]"}]}], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"afa8d054-ff3f-4bc4-8eef-d418df14e7e1"],

Cell[BoxData[
 RowBox[{"Sort", "[", "\[Lambda]", "]"}]], "Input",
 CellChangeTimes->{{3.906831179524393*^9, 3.9068311848309317`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"680b3caf-f017-4443-a061-f2a63a86dc6d"],

Cell[BoxData[
 RowBox[{"Sort", "[", "\[Mu]", "]"}]], "Input",
 CellChangeTimes->{{3.906831180452635*^9, 3.9068311890759172`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"c07dd831-e06d-4782-9432-bcd30a348441"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", "\[Transpose]"}], "-", "A"}]], "Input",
 CellChangeTimes->{{3.906831384511105*^9, 3.906831386853064*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"25b5f11f-3ccd-47b9-8cc4-8d92ad7d45fa"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906822708010228*^9, 3.9068227322119007`*^9}, {
   3.906822946576481*^9, 3.906822963328086*^9}, 
   3.906831177236047*^9},ExpressionUUID->"cf801a4b-014a-4ac7-94e2-\
ba0af724d5da"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906831068161414*^9, 
  3.906831104775256*^9}},ExpressionUUID->"7503a587-db48-4453-9d6f-\
1c734c77d298"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sort", "[", "\[Lambda]", "]"}], "-", 
  RowBox[{"Sort", "[", 
   RowBox[{"Eigenvalues", "[", "A", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9068229410744257`*^9, 3.9068229417137737`*^9}, {
  3.9068230288207397`*^9, 3.906823029069515*^9}, {3.906823064680973*^9, 
  3.9068230755092783`*^9}, {3.906829366244183*^9, 3.906829366453425*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"25299bd5-5a97-49ba-b999-26af29367e1e"],

Cell[BoxData[
 RowBox[{"Sort", "[", "\[Mu]", "]"}]], "Input",
 CellChangeTimes->{{3.906831110382537*^9, 3.906831121693162*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"70ca5943-1736-4449-b2b6-b35af3d66329"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9068312151439943`*^9, 3.906831232283475*^9}, 
   3.906832231883032*^9},ExpressionUUID->"6814be8e-7376-44bb-badf-\
4b2ae1e9cc50"],

Cell[BoxData[
 RowBox[{"Sort", "[", "\[Lambda]", "]"}]], "Input",
 CellChangeTimes->{{3.906831112236066*^9, 3.9068311184619017`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"40bd5ccf-a90f-4aa6-a20c-168c7c4a2f48"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"U", "\[Transpose]"}], ".", 
     RowBox[{"(", 
      RowBox[{"\[Mu]", " ", "U"}], ")"}]}], "-", "A"}], "//", "Chop"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.9068310801061153`*^9, 3.9068310926413717`*^9}, {
  3.90683113856765*^9, 3.906831139064582*^9}, {3.9068312363312407`*^9, 
  3.9068312387045927`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"a9c8f73b-7ab4-4193-ba39-97db90a5bffc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906832236260957*^9, 
  3.906832243234221*^9}},ExpressionUUID->"aaad96f6-6095-4d22-9c9f-\
b7ae05ec502e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Q", "\[Transpose]"}], ".", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]", " ", "Q"}], ")"}]}], "-", "A"}], "//", "Chop"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.90682308968585*^9, 3.906823109187689*^9}, {
  3.9068310968156652`*^9, 3.906831100057144*^9}, {3.906831244554378*^9, 
  3.906831246982752*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"152a97f7-a1eb-4e30-b33d-db3cc1914074"],

Cell[BoxData[
 RowBox[{"B", "=", 
  RowBox[{"A", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{";;", "3"}], ",", 
     RowBox[{";;", "3"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.906823137576036*^9, 3.906823165178154*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"ff47635a-2d5d-492e-a9e9-76ec4e1dd0fd"],

Cell[BoxData[
 RowBox[{"B", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{
  3.906823098497938*^9, {3.906823151017859*^9, 3.9068231522449217`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"1ffdb137-e1af-477a-9bef-b65be7da0110"],

Cell[BoxData[
 RowBox[{"p", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{"3", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", 
    RowBox[{"Range", "[", 
     RowBox[{"4", ",", "10"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.906823241760357*^9, 3.906823266441454*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"84854f7e-9f53-408b-8d40-1afa77d29b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"cEigs", "[", 
   RowBox[{"Length", "[", "A", "]"}], "]"}], "[", 
  RowBox[{
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{"p", ",", "p"}], "]"}], "]"}], ",", "Q", ",", "\[Lambda]", ",", 
   "tol", ",", "maxiter"}], "]"}]], "Input",
 CellChangeTimes->{3.90682330476855*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"66cbf7c5-755f-41ec-bdd1-dcfd20a955a7"],

Cell[BoxData["Q"], "Input",
 CellChangeTimes->{3.9068233074227877`*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"fa1861c1-d873-48ef-9057-ab62d7f65a2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sort", "[", "\[Lambda]", "]"}], "-", 
  RowBox[{"Sort", "[", 
   RowBox[{"Eigenvalues", "[", "A", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9068233084671383`*^9, 3.906823324588237*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"29e60d14-f921-4799-bfeb-1a9b5b7dd783"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9068233112957087`*^9, 
  3.90682332313748*^9}},ExpressionUUID->"25ab37cf-dc93-4fba-9475-\
b894407afb44"],

Cell[BoxData[{
 RowBox[{"A", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "[", 
   RowBox[{"[", 
    RowBox[{"p", ",", "p"}], "]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.90682326875065*^9, 3.9068232741491003`*^9}, {
  3.906823437102997*^9, 3.906823440032827*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"af9279ef-a399-4cd5-8901-7c28dc833565"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9068230675330753`*^9, 
  3.906823074346051*^9}},ExpressionUUID->"04a664f4-8916-4949-8a22-\
cc4e408a476c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Chop", "[", 
   RowBox[{
    RowBox[{"Q", "\[Transpose]"}], ".", "Q"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.906823041232353*^9, 3.906823051753333*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"634550f1-5913-4923-9c9e-df9fc1b064e9"],

Cell[BoxData[
 RowBox[{"Q", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.906823030682373*^9, 3.906823034978476*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"60109e8a-d80a-4159-8df5-1c5e1a07f38c"],

Cell[BoxData["Q"], "Input",
 CellChangeTimes->{3.906822973058464*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"57bdb93f-efb0-4c4c-9e89-58323392d7b6"],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.906820950463462*^9, 3.906820951774589*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"3543d944-4c2c-43ce-b54f-774158931b60"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.906820962386451*^9, 3.906820963765752*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"24f544ba-5384-49ee-921d-95e2c6bd84ac"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Sort", "[", 
  RowBox[{
   RowBox[{"cHessEigs", "[", "10", "]"}], "[", 
   RowBox[{"diag", ",", "upper", ",", "0.00000001", ",", "16"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", 
  RowBox[{"Eigenvalues", "[", "A", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.906821702440398*^9, 3.906821704794754*^9}, {
   3.906822075183132*^9, 3.906822119137825*^9}, 
   3.906822652544491*^9},ExpressionUUID->"fa94443c-55e7-4423-b57a-\
9795f131ea99"],

Cell[CellGroupData[{

Cell[BoxData["\"\<Compiling cHessEigs_10...\>\""], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.9068223296928988`*^9, 
   3.906822652733328*^9},ExpressionUUID->"3b7e9ebf-974d-49b2-bf6b-\
2d47899324c6"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Compilation done. Time elapsed = \"\>", "\[InvisibleSpace]", 
   "0.882757`", "\[InvisibleSpace]", "\<\" s.\\n\"\>"}],
  SequenceForm["Compilation done. Time elapsed = ", 0.882757, " s.\n"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.906822330566348*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"ad7a743b-3c5e-419d-9492-edfc553cbf9d"],

Cell[BoxData["\<\"WARNING: \
Tiny::SelfAdjointTridiagonalMatrix<10,R64,I64>::qr_algorithm for m = 9: \
Failed to converge after max_iter = 16 iterations.\"\>"], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.906822331409861*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"ef84777d-9abf-4e27-92a4-c0a77bd4cbf2"],

Cell[BoxData["\<\"diag = { 0.7164456059056875, 0.646318654435192, \
0.8480239871470804, 1.374649197314393, 1.522679317474652, 1.300688473844811, \
0.0001279344535252102, 0.02585541955192211, 0.09940895528250084, \
4.46580245459024 }\"\>"], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.906822331416513*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"284130ef-0237-4a96-b502-51fc7cdb4637"],

Cell[BoxData["\<\"upper = { 1.27257337083811e-10, 1.053016691281566e-08, \
1.729973058742154e-17, -1.078212738371189e-12, -2.081400098746483e-19, \
5.148565077416752e-23, 1.042751245077245e-13, 0.0007737845501044303, \
5.173643885572209e-74 }\"\>"], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.906822331423009*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"7e9d17ac-6a27-4dec-b776-8b08b485362c"],

Cell[BoxData["\<\"Abs(upper[m-2]) = 0.0007737845501044303\"\>"], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.906822331428692*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"91ef9319-3de1-4eac-8e10-3abba5bcdde4"],

Cell[BoxData["\<\"tol * (Abs(diag[m-2])+Abs(diag[m-1])) = \
1.252643748344229e-09\"\>"], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.906822331433948*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"6cd8d9ee-2aec-466f-bab1-db1595493158"],

Cell[BoxData["\<\"tol = 1e-08\"\>"], "Print",
 CellChangeTimes->{{3.906822093345624*^9, 3.9068221194257298`*^9}, 
   3.9068223314389544`*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"27569641-ea40-405f-a172-8ef58ca5a74a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0001279344535252102`", ",", "0.02585541955192211`", ",", 
   "0.09940895528250084`", ",", "0.6463186544351914`", ",", 
   "0.7164456059056875`", ",", "0.8480239871470809`", ",", 
   "1.300688473844811`", ",", "1.374649197314393`", ",", "1.522679317474652`",
    ",", "4.46580245459024`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.906821705163021*^9, 3.906821750165628*^9, {3.906821807791957*^9, 
   3.90682185697724*^9}, {3.906821966699439*^9, 3.9068219834457693`*^9}, {
   3.9068220681453333`*^9, 3.9068221194569674`*^9}, 3.906822331444036*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"6003544b-a9d6-45df-8b62-4574b286664d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0001279344535252102`", ",", "0.025847280224894666`", ",", 
   "0.09941709460952827`", ",", "0.6463186544351917`", ",", 
   "0.7164456059056875`", ",", "0.8480239871470807`", ",", 
   "1.300688473844811`", ",", "1.374649197314393`", ",", "1.522679317474652`",
    ",", "4.46580245459024`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.906821705163021*^9, 3.906821750165628*^9, {3.906821807791957*^9, 
   3.90682185697724*^9}, {3.906821966699439*^9, 3.9068219834457693`*^9}, {
   3.9068220681453333`*^9, 3.9068221194569674`*^9}, 3.906822331449586*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"ad270e56-1215-4bee-bb44-39ae0a4509d9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cHessEigs", "[", "3", "]"}], "[", 
  RowBox[{
   RowBox[{"diag", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
   RowBox[{"upper", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "2"}], "]"}], "]"}], ",", "0.00000001", ",", "16"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.906822216777504*^9, 3.90682225416374*^9}, 
   3.906822652931739*^9},ExpressionUUID->"2aa83c37-c816-4b37-9577-\
c7878024a3a1"],

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"A", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", 
      RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.906822357639174*^9, 3.9068223664392157`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"d9d4d7b3-587c-4100-a62d-8046ea722495"],

Cell[BoxData["upper"], "Input",
 CellChangeTimes->{{3.906822187369816*^9, 3.906822188092024*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"cc6a01ed-ac2c-4c93-a2df-d8ba339d3616"],

Cell[BoxData["diag"], "Input",
 CellChangeTimes->{{3.906822196905141*^9, 3.906822197382249*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"dbbf4f6b-a5da-48ce-8eea-ca2ab3c89b09"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9068221109647408`*^9, 
  3.906822117797386*^9}},ExpressionUUID->"17cfe293-57b6-4e9b-be43-\
bfa4e2b6c4f7"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.90682179648172*^9, 
  3.9068217988076563`*^9}},ExpressionUUID->"c7336ec7-4d28-4c35-bfef-\
a46c6fab611d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"diag", "=", 
   RowBox[{"{", 
    RowBox[{
    "4.478939414804273", ",", " ", "0.6890628945226929", ",", " ", 
     "0.008804655321067263", ",", " ", "0.3263904960781385", ",", " ", 
     "0.2296825524558708", ",", " ", "0.07110426641615522", ",", " ", 
     "1.625996773193554", ",", " ", "0.9726968813782627", ",", " ", 
     "1.396159065327755", ",", " ", "1.201163000502229"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"upper", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2.294588984023288", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "29"}]}]}], ",", " ", "0.03637686399714461", ",", " ", 
     RowBox[{"5.658630690535425", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "18"}]}]}], ",", " ", 
     RowBox[{"2.768680430197221", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "22"}]}]}], ",", " ", 
     RowBox[{"1.130938968620395", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "13"}]}]}], ",", " ", 
     RowBox[{"2.918170117633394", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "14"}]}]}], ",", " ", 
     RowBox[{"8.627978930551849", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "13"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"-", "3.051041061918062"}], " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "11"}]}]}], ",", " ", 
     RowBox[{
      RowBox[{"-", "2.204701811138811"}], " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "14"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.906817689104741*^9, 3.9068177274094133`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"2aede6c3-4068-4355-be91-a6064deffcf9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.906817728182585*^9, 3.906817745293914*^9}, 
   3.906820945576264*^9},ExpressionUUID->"280609bb-b808-436f-b060-\
9e13761a0b07"],

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", "A", "]"}]], "Input",
 CellChangeTimes->{{3.906817746290441*^9, 3.906817747539846*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"822cba85-b5da-43ca-9c42-53dcb3bf0366"]
},
WindowSize->{1496, 905},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (January 30, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cdf51498-daff-477f-8bde-30e4d8ba9cc2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 177, 2, 41, "Input",ExpressionUUID->"e900fb1a-6400-48b5-9ddb-415fcad81665"],
Cell[738, 24, 779, 16, 92, "Input",ExpressionUUID->"a14e8661-385b-49e8-846a-93b79486cbef"],
Cell[1520, 42, 5614, 112, 1967, "Input",ExpressionUUID->"8c260fe9-ea94-4689-93c0-e950cc7e7119"],
Cell[7137, 156, 1427, 44, 192, "Input",ExpressionUUID->"02cd7682-3580-42d3-ad26-b7e7fd0517b6"],
Cell[8567, 202, 276, 4, 67, "Input",ExpressionUUID->"a288e2c6-d9ea-47c4-b1d5-fd60e4fbd058"],
Cell[8846, 208, 608, 18, 67, "Input",ExpressionUUID->"b9fe3a26-a418-46c5-ae6c-2600da551291"],
Cell[9457, 228, 151, 3, 41, "Input",ExpressionUUID->"29cf32c6-cdea-4a6a-9faf-5c27360dae2b"],
Cell[9611, 233, 208, 4, 92, "Input",ExpressionUUID->"36b81ab2-0067-4582-ab3c-254210b8e980"],
Cell[9822, 239, 1726, 40, 242, "Input",ExpressionUUID->"47b4291b-5a3a-4d7d-b062-f8ae92b4cb6a"],
Cell[11551, 281, 2322, 48, 217, "Input",ExpressionUUID->"1496a5fd-43e1-4cbd-b75a-3c2eaa89748c"],
Cell[13876, 331, 206, 3, 41, "Input",ExpressionUUID->"317a3449-cf3d-4651-996c-0235515970c8"],
Cell[14085, 336, 5620, 113, 2067, "Input",ExpressionUUID->"afba0aeb-6753-4f16-8faa-02863b15957a"],
Cell[19708, 451, 3563, 93, 442, "Input",ExpressionUUID->"2840e546-db6e-4ab3-9a4a-7d16138034f9"],
Cell[23274, 546, 542, 17, 67, "Input",ExpressionUUID->"afa8d054-ff3f-4bc4-8eef-d418df14e7e1"],
Cell[23819, 565, 212, 3, 41, "Input",ExpressionUUID->"680b3caf-f017-4443-a061-f2a63a86dc6d"],
Cell[24034, 570, 208, 3, 41, "Input",ExpressionUUID->"c07dd831-e06d-4782-9432-bcd30a348441"],
Cell[24245, 575, 223, 4, 41, "Input",ExpressionUUID->"25b5f11f-3ccd-47b9-8cc4-8d92ad7d45fa"],
Cell[24471, 581, 227, 4, 41, "Input",ExpressionUUID->"cf801a4b-014a-4ac7-94e2-ba0af724d5da"],
Cell[24701, 587, 152, 3, 41, "Input",ExpressionUUID->"7503a587-db48-4453-9d6f-1c734c77d298"],
Cell[24856, 592, 455, 8, 41, "Input",ExpressionUUID->"25299bd5-5a97-49ba-b999-26af29367e1e"],
Cell[25314, 602, 206, 3, 41, "Input",ExpressionUUID->"70ca5943-1736-4449-b2b6-b35af3d66329"],
Cell[25523, 607, 177, 3, 41, "Input",ExpressionUUID->"6814be8e-7376-44bb-badf-4b2ae1e9cc50"],
Cell[25703, 612, 212, 3, 41, "Input",ExpressionUUID->"40bd5ccf-a90f-4aa6-a20c-168c7c4a2f48"],
Cell[25918, 617, 477, 12, 41, "Input",ExpressionUUID->"a9c8f73b-7ab4-4193-ba39-97db90a5bffc"],
Cell[26398, 631, 152, 3, 41, "Input",ExpressionUUID->"aaad96f6-6095-4d22-9c9f-b7ae05ec502e"],
Cell[26553, 636, 475, 12, 41, "Input",ExpressionUUID->"152a97f7-a1eb-4e30-b33d-db3cc1914074"],
Cell[27031, 650, 315, 8, 41, "Input",ExpressionUUID->"ff47635a-2d5d-492e-a9e9-76ec4e1dd0fd"],
Cell[27349, 660, 231, 4, 41, "Input",ExpressionUUID->"1ffdb137-e1af-477a-9bef-b65be7da0110"],
Cell[27583, 666, 402, 10, 41, "Input",ExpressionUUID->"84854f7e-9f53-408b-8d40-1afa77d29b08"],
Cell[27988, 678, 393, 10, 41, "Input",ExpressionUUID->"66cbf7c5-755f-41ec-bdd1-dcfd20a955a7"],
Cell[28384, 690, 150, 2, 41, "Input",ExpressionUUID->"fa1861c1-d873-48ef-9057-ab62d7f65a2c"],
Cell[28537, 694, 305, 6, 41, "Input",ExpressionUUID->"29e60d14-f921-4799-bfeb-1a9b5b7dd783"],
Cell[28845, 702, 153, 3, 41, "Input",ExpressionUUID->"25ab37cf-dc93-4fba-9475-b894407afb44"],
Cell[29001, 707, 393, 8, 67, "Input",ExpressionUUID->"af9279ef-a399-4cd5-8901-7c28dc833565"],
Cell[29397, 717, 154, 3, 41, "Input",ExpressionUUID->"04a664f4-8916-4949-8a22-cc4e408a476c"],
Cell[29554, 722, 293, 7, 41, "Input",ExpressionUUID->"634550f1-5913-4923-9c9e-df9fc1b064e9"],
Cell[29850, 731, 204, 3, 41, "Input",ExpressionUUID->"60109e8a-d80a-4159-8df5-1c5e1a07f38c"],
Cell[30057, 736, 148, 2, 41, "Input",ExpressionUUID->"57bdb93f-efb0-4c4c-9e89-58323392d7b6"],
Cell[30208, 740, 209, 3, 41, "Input",ExpressionUUID->"3543d944-4c2c-43ce-b54f-774158931b60"],
Cell[30420, 745, 208, 3, 41, "Input",ExpressionUUID->"24f544ba-5384-49ee-921d-95e2c6bd84ac"],
Cell[CellGroupData[{
Cell[30653, 752, 484, 11, 67, "Input",ExpressionUUID->"fa94443c-55e7-4423-b57a-9795f131ea99"],
Cell[CellGroupData[{
Cell[31162, 767, 288, 6, 30, "Print",ExpressionUUID->"3b7e9ebf-974d-49b2-bf6b-2d47899324c6"],
Cell[31453, 775, 468, 10, 54, "Print",ExpressionUUID->"ad7a743b-3c5e-419d-9492-edfc553cbf9d"],
Cell[31924, 787, 368, 7, 54, "Print",ExpressionUUID->"ef84777d-9abf-4e27-92a4-c0a77bd4cbf2"],
Cell[32295, 796, 447, 8, 54, "Print",ExpressionUUID->"284130ef-0237-4a96-b502-51fc7cdb4637"],
Cell[32745, 806, 457, 8, 54, "Print",ExpressionUUID->"7e9d17ac-6a27-4dec-b776-8b08b485362c"],
Cell[33205, 816, 272, 5, 30, "Print",ExpressionUUID->"91ef9319-3de1-4eac-8e10-3abba5bcdde4"],
Cell[33480, 823, 296, 6, 30, "Print",ExpressionUUID->"6cd8d9ee-2aec-466f-bab1-db1595493158"],
Cell[33779, 831, 246, 5, 30, "Print",ExpressionUUID->"27569641-ea40-405f-a172-8ef58ca5a74a"]
}, Open  ]],
Cell[34040, 839, 671, 12, 47, "Output",ExpressionUUID->"6003544b-a9d6-45df-8b62-4574b286664d"],
Cell[34714, 853, 672, 12, 47, "Output",ExpressionUUID->"ad270e56-1215-4bee-bb44-39ae0a4509d9"]
}, Open  ]],
Cell[35401, 868, 463, 13, 41, "Input",ExpressionUUID->"2aa83c37-c816-4b37-9577-c7878024a3a1"],
Cell[35867, 883, 378, 9, 41, "Input",ExpressionUUID->"d9d4d7b3-587c-4100-a62d-8046ea722495"],
Cell[36248, 894, 176, 2, 41, "Input",ExpressionUUID->"cc6a01ed-ac2c-4c93-a2df-d8ba339d3616"],
Cell[36427, 898, 175, 2, 41, "Input",ExpressionUUID->"dbbf4f6b-a5da-48ce-8eea-ca2ab3c89b09"],
Cell[36605, 902, 154, 3, 41, "Input",ExpressionUUID->"17cfe293-57b6-4e9b-be43-bfa4e2b6c4f7"],
Cell[36762, 907, 153, 3, 41, "Input",ExpressionUUID->"c7336ec7-4d28-4c35-bfef-a46c6fab611d"],
Cell[36918, 912, 1639, 42, 167, "Input",ExpressionUUID->"2aede6c3-4068-4355-be91-a6064deffcf9"],
Cell[38560, 956, 175, 3, 41, "Input",ExpressionUUID->"280609bb-b808-436f-b060-9e13761a0b07"],
Cell[38738, 961, 209, 3, 41, "Input",ExpressionUUID->"822cba85-b5da-43ca-9c42-53dcb3bf0366"]
}
]
*)

